"use strict";

exports.__esModule = true;
exports["default"] = exports.inputRender = void 0;

var _formatUtils = require("@opuscapita/format-utils");

var _reactFormattedInput = require("@opuscapita/react-formatted-input");

var _react = _interopRequireDefault(require("react"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var inputRender = function inputRender(formattedInputProps) {
  return /*#__PURE__*/_react["default"].createElement(_reactFormattedInput.FormattedInputCurrency, formattedInputProps);
};

exports.inputRender = inputRender;

var getCurrencyKeyPath = function getCurrencyKeyPath(col) {
  return col.valueOptions && col.valueOptions.currencyKeyPath || ['currency'];
};

var _default = {
  // currencyValueRender
  valRender: function valRender(col, gridData, rowIndex, thousandSeparator, decimalSeparator, valueRender) {
    return valueRender(rowIndex, function (v) {
      return (0, _formatUtils.formatCurrencyAmount)(v, {
        currency: gridData.getIn([rowIndex].concat(getCurrencyKeyPath(col))) || col.valueOptions && col.valueOptions.currency,
        decimals: col.valueOptions && col.valueOptions.decimals,
        thousandSeparator: col.valueOptions && col.valueOptions.thousandSeparator || thousandSeparator,
        decimalSeparator: col.valueOptions && col.valueOptions.decimalSeparator || decimalSeparator,
        multiplier: col.valueOptions && col.valueOptions.multiplier
      });
    });
  },
  cellEdit: function cellEdit(col, column, tabIndex, rowIndex, gridId, functions, editValueParser, getComponentDisabledState, gridData, thousandSeparator, decimalSeparator) {
    var cellName = 'edit';

    var props = _extends({
      className: 'form-control',
      value: functions.getItemValue(rowIndex, col),
      onChange: functions.onCellValueChange(rowIndex, col, function (val) {
        return val;
      }),
      inputProps: {
        disabled: getComponentDisabledState(rowIndex, col, cellName),
        id: "ocDatagridEditInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        name: "ocDatagridEditInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
        onKeyDown: functions.onCellKeyDown(rowIndex, col),
        ref: functions.handleCellRef(rowIndex, col),
        style: column.style
      },
      currency: gridData.getIn([rowIndex].concat(getCurrencyKeyPath(col))) || col.valueOptions && col.valueOptions.currency,
      decimalSeparator: col.valueOptions && col.valueOptions.decimalSeparator || decimalSeparator,
      thousandSeparator: col.valueOptions && col.valueOptions.thousandSeparator || thousandSeparator,
      decimals: col.valueOptions && col.valueOptions.decimals,
      tabIndex: tabIndex,
      onBlur: functions.onCellBlur(rowIndex, col)
    }, col.editComponentProps);

    return inputRender(_extends({}, props));
  },
  cellCreate: function cellCreate(col, column, tabIndex, rowIndex, gridId, functions, editValueParser, getComponentDisabledState, gridData, thousandSeparator, decimalSeparator) {
    var cellName = 'create';

    var props = _extends({
      className: 'form-control',
      value: functions.getItemValue(rowIndex, col),
      onChange: functions.onCellValueChange(rowIndex, col, function (val) {
        return val;
      }),
      inputProps: {
        disabled: getComponentDisabledState(rowIndex, col, cellName),
        id: "ocDatagridCreateInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        name: "ocDatagridCreateInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
        onKeyDown: functions.onCellKeyDown(rowIndex, col),
        ref: functions.handleCellRef(rowIndex, col),
        style: column.style
      },
      currency: gridData.getIn([rowIndex].concat(getCurrencyKeyPath(col))) || col.valueOptions && col.valueOptions.currency,
      decimalSeparator: col.valueOptions && col.valueOptions.decimalSeparator || decimalSeparator,
      thousandSeparator: col.valueOptions && col.valueOptions.thousandSeparator || thousandSeparator,
      decimals: col.valueOptions && col.valueOptions.decimals,
      tabIndex: tabIndex,
      onBlur: functions.onCellBlur(rowIndex, col)
    }, col.createComponentProps);

    return inputRender(_extends({}, props));
  } // Cell filtering is handled by primitive-renderers cellFilter function
  // Check column-service.jsx

};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYXRhZ3JpZC9jb2x1bW4tc2VydmljZS9jb2x1bW4tdHlwZXMvY3VycmVuY3ktcmVuZGVyZXJzLmpzeCJdLCJuYW1lcyI6WyJpbnB1dFJlbmRlciIsImZvcm1hdHRlZElucHV0UHJvcHMiLCJnZXRDdXJyZW5jeUtleVBhdGgiLCJjb2wiLCJ2YWx1ZU9wdGlvbnMiLCJjdXJyZW5jeUtleVBhdGgiLCJ2YWxSZW5kZXIiLCJncmlkRGF0YSIsInJvd0luZGV4IiwidGhvdXNhbmRTZXBhcmF0b3IiLCJkZWNpbWFsU2VwYXJhdG9yIiwidmFsdWVSZW5kZXIiLCJ2IiwiY3VycmVuY3kiLCJnZXRJbiIsImRlY2ltYWxzIiwibXVsdGlwbGllciIsImNlbGxFZGl0IiwiY29sdW1uIiwidGFiSW5kZXgiLCJncmlkSWQiLCJmdW5jdGlvbnMiLCJlZGl0VmFsdWVQYXJzZXIiLCJnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlIiwiY2VsbE5hbWUiLCJwcm9wcyIsImNsYXNzTmFtZSIsInZhbHVlIiwiZ2V0SXRlbVZhbHVlIiwib25DaGFuZ2UiLCJvbkNlbGxWYWx1ZUNoYW5nZSIsInZhbCIsImlucHV0UHJvcHMiLCJkaXNhYmxlZCIsImlkIiwiY29sdW1uS2V5IiwibmFtZSIsIm9uRm9jdXMiLCJvbkNlbGxGb2N1cyIsImNvbXBvbmVudFR5cGUiLCJvbktleURvd24iLCJvbkNlbGxLZXlEb3duIiwicmVmIiwiaGFuZGxlQ2VsbFJlZiIsInN0eWxlIiwib25CbHVyIiwib25DZWxsQmx1ciIsImVkaXRDb21wb25lbnRQcm9wcyIsImNlbGxDcmVhdGUiLCJjcmVhdGVDb21wb25lbnRQcm9wcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7O0FBRU8sSUFBTUEsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBQUMsbUJBQW1CO0FBQUEsc0JBQzVDLGdDQUFDLDJDQUFELEVBQTRCQSxtQkFBNUIsQ0FENEM7QUFBQSxDQUF2Qzs7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LENBQUNDLFlBQUosQ0FBaUJNLGdCQUF0QyxJQUEyREEsZ0JBZnBFO0FBZ0JURCxNQUFBQSxpQkFBaUIsRUFBR04sR0FBRyxDQUFDQyxZQUFKLElBQW9CRCxHQUFHLENBQUNDLFlBQUosQ0FBaUJLLGlCQUF0QyxJQUNkQSxpQkFqQkk7QUFrQlRNLE1BQUFBLFFBQVEsRUFBRVosR0FBRyxDQUFDQyxZQUFKLElBQW9CRCxHQUFHLENBQUNDLFlBQUosQ0FBaUJXLFFBbEJ0QztBQW1CVEksTUFBQUEsUUFBUSxFQUFSQSxRQW5CUztBQW9CVDBCLE1BQUFBLE1BQU0sRUFBRXhCLFNBQVMsQ0FBQ3lCLFVBQVYsQ0FBcUJ0QyxRQUFyQixFQUErQkwsR0FBL0I7QUFwQkMsT0FxQk5BLEdBQUcsQ0FBQzhDLG9CQXJCRSxDQUFYOztBQXdCQSxXQUFPakQsV0FBVyxjQUFNeUIsS0FBTixFQUFsQjtBQUNELEdBOUZZLENBK0ZiO0FBQ0E7O0FBaEdhLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmb3JtYXRDdXJyZW5jeUFtb3VudCB9IGZyb20gJ0BvcHVzY2FwaXRhL2Zvcm1hdC11dGlscyc7XG5pbXBvcnQgeyBGb3JtYXR0ZWRJbnB1dEN1cnJlbmN5IH0gZnJvbSAnQG9wdXNjYXBpdGEvcmVhY3QtZm9ybWF0dGVkLWlucHV0JztcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmV4cG9ydCBjb25zdCBpbnB1dFJlbmRlciA9IGZvcm1hdHRlZElucHV0UHJvcHMgPT4gKFxuICA8Rm9ybWF0dGVkSW5wdXRDdXJyZW5jeSB7Li4uZm9ybWF0dGVkSW5wdXRQcm9wc30gLz5cbik7XG5cbmNvbnN0IGdldEN1cnJlbmN5S2V5UGF0aCA9IGNvbCA9PiAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLmN1cnJlbmN5S2V5UGF0aCkgfHwgWydjdXJyZW5jeSddO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIC8vIGN1cnJlbmN5VmFsdWVSZW5kZXJcbiAgdmFsUmVuZGVyKGNvbCwgZ3JpZERhdGEsIHJvd0luZGV4LCB0aG91c2FuZFNlcGFyYXRvciwgZGVjaW1hbFNlcGFyYXRvciwgdmFsdWVSZW5kZXIpIHtcbiAgICByZXR1cm4gdmFsdWVSZW5kZXIocm93SW5kZXgsIHYgPT4gZm9ybWF0Q3VycmVuY3lBbW91bnQodiwge1xuICAgICAgY3VycmVuY3k6IGdyaWREYXRhLmdldEluKFtyb3dJbmRleCwgLi4uZ2V0Q3VycmVuY3lLZXlQYXRoKGNvbCldKVxuICAgICAgICB8fCAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLmN1cnJlbmN5KSxcbiAgICAgIGRlY2ltYWxzOiBjb2wudmFsdWVPcHRpb25zICYmIGNvbC52YWx1ZU9wdGlvbnMuZGVjaW1hbHMsXG4gICAgICB0aG91c2FuZFNlcGFyYXRvcjpcbiAgICAgICAgKGNvbC52YWx1ZU9wdGlvbnMgJiYgY29sLnZhbHVlT3B0aW9ucy50aG91c2FuZFNlcGFyYXRvcikgfHwgdGhvdXNhbmRTZXBhcmF0b3IsXG4gICAgICBkZWNpbWFsU2VwYXJhdG9yOlxuICAgICAgICAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLmRlY2ltYWxTZXBhcmF0b3IpIHx8IGRlY2ltYWxTZXBhcmF0b3IsXG4gICAgICBtdWx0aXBsaWVyOlxuICAgICAgICAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLm11bHRpcGxpZXIpLFxuICAgIH0pKTtcbiAgfSxcbiAgY2VsbEVkaXQoXG4gICAgY29sLFxuICAgIGNvbHVtbixcbiAgICB0YWJJbmRleCxcbiAgICByb3dJbmRleCxcbiAgICBncmlkSWQsXG4gICAgZnVuY3Rpb25zLFxuICAgIGVkaXRWYWx1ZVBhcnNlcixcbiAgICBnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlLFxuICAgIGdyaWREYXRhLFxuICAgIHRob3VzYW5kU2VwYXJhdG9yLFxuICAgIGRlY2ltYWxTZXBhcmF0b3IsXG4gICkge1xuICAgIGNvbnN0IGNlbGxOYW1lID0gJ2VkaXQnO1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgY2xhc3NOYW1lOiAnZm9ybS1jb250cm9sJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbnMuZ2V0SXRlbVZhbHVlKHJvd0luZGV4LCBjb2wpLFxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9ucy5vbkNlbGxWYWx1ZUNoYW5nZShyb3dJbmRleCwgY29sLCB2YWwgPT4gdmFsKSxcbiAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgZGlzYWJsZWQ6IGdldENvbXBvbmVudERpc2FibGVkU3RhdGUocm93SW5kZXgsIGNvbCwgY2VsbE5hbWUpLFxuICAgICAgICBpZDogYG9jRGF0YWdyaWRFZGl0SW5wdXQtJHtncmlkSWR9LSR7Y29sdW1uLmNvbHVtbktleX0tJHtyb3dJbmRleH1gLFxuICAgICAgICBuYW1lOiBgb2NEYXRhZ3JpZEVkaXRJbnB1dC0ke2dyaWRJZH0tJHtjb2x1bW4uY29sdW1uS2V5fS0ke3Jvd0luZGV4fWAsXG4gICAgICAgIG9uRm9jdXM6IGZ1bmN0aW9ucy5vbkNlbGxGb2N1cyhjZWxsTmFtZSwgY29sLmNvbXBvbmVudFR5cGUsIHJvd0luZGV4LCBjb2x1bW4uY29sdW1uS2V5KSxcbiAgICAgICAgb25LZXlEb3duOiBmdW5jdGlvbnMub25DZWxsS2V5RG93bihyb3dJbmRleCwgY29sKSxcbiAgICAgICAgcmVmOiBmdW5jdGlvbnMuaGFuZGxlQ2VsbFJlZihyb3dJbmRleCwgY29sKSxcbiAgICAgICAgc3R5bGU6IGNvbHVtbi5zdHlsZSxcbiAgICAgIH0sXG4gICAgICBjdXJyZW5jeTogZ3JpZERhdGEuZ2V0SW4oW3Jvd0luZGV4LCAuLi5nZXRDdXJyZW5jeUtleVBhdGgoY29sKV0pXG4gICAgICAgIHx8IChjb2wudmFsdWVPcHRpb25zICYmIGNvbC52YWx1ZU9wdGlvbnMuY3VycmVuY3kpLFxuICAgICAgZGVjaW1hbFNlcGFyYXRvcjogKGNvbC52YWx1ZU9wdGlvbnMgJiYgY29sLnZhbHVlT3B0aW9ucy5kZWNpbWFsU2VwYXJhdG9yKSB8fCBkZWNpbWFsU2VwYXJhdG9yLFxuICAgICAgdGhvdXNhbmRTZXBhcmF0b3I6IChjb2wudmFsdWVPcHRpb25zICYmIGNvbC52YWx1ZU9wdGlvbnMudGhvdXNhbmRTZXBhcmF0b3IpXG4gICAgICAgIHx8IHRob3VzYW5kU2VwYXJhdG9yLFxuICAgICAgZGVjaW1hbHM6IGNvbC52YWx1ZU9wdGlvbnMgJiYgY29sLnZhbHVlT3B0aW9ucy5kZWNpbWFscyxcbiAgICAgIHRhYkluZGV4LFxuICAgICAgb25CbHVyOiBmdW5jdGlvbnMub25DZWxsQmx1cihyb3dJbmRleCwgY29sKSxcbiAgICAgIC4uLmNvbC5lZGl0Q29tcG9uZW50UHJvcHMsXG4gICAgfTtcblxuICAgIHJldHVybiBpbnB1dFJlbmRlcih7IC4uLnByb3BzIH0pO1xuICB9LFxuICBjZWxsQ3JlYXRlKFxuICAgIGNvbCxcbiAgICBjb2x1bW4sXG4gICAgdGFiSW5kZXgsXG4gICAgcm93SW5kZXgsXG4gICAgZ3JpZElkLFxuICAgIGZ1bmN0aW9ucyxcbiAgICBlZGl0VmFsdWVQYXJzZXIsXG4gICAgZ2V0Q29tcG9uZW50RGlzYWJsZWRTdGF0ZSxcbiAgICBncmlkRGF0YSxcbiAgICB0aG91c2FuZFNlcGFyYXRvcixcbiAgICBkZWNpbWFsU2VwYXJhdG9yLFxuICApIHtcbiAgICBjb25zdCBjZWxsTmFtZSA9ICdjcmVhdGUnO1xuICAgIGNvbnN0IHByb3BzID0ge1xuICAgICAgY2xhc3NOYW1lOiAnZm9ybS1jb250cm9sJyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbnMuZ2V0SXRlbVZhbHVlKHJvd0luZGV4LCBjb2wpLFxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9ucy5vbkNlbGxWYWx1ZUNoYW5nZShyb3dJbmRleCwgY29sLCB2YWwgPT4gdmFsKSxcbiAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgZGlzYWJsZWQ6IGdldENvbXBvbmVudERpc2FibGVkU3RhdGUocm93SW5kZXgsIGNvbCwgY2VsbE5hbWUpLFxuICAgICAgICBpZDogYG9jRGF0YWdyaWRDcmVhdGVJbnB1dC0ke2dyaWRJZH0tJHtjb2x1bW4uY29sdW1uS2V5fS0ke3Jvd0luZGV4fWAsXG4gICAgICAgIG5hbWU6IGBvY0RhdGFncmlkQ3JlYXRlSW5wdXQtJHtncmlkSWR9LSR7Y29sdW1uLmNvbHVtbktleX0tJHtyb3dJbmRleH1gLFxuICAgICAgICBvbkZvY3VzOiBmdW5jdGlvbnMub25DZWxsRm9jdXMoY2VsbE5hbWUsIGNvbC5jb21wb25lbnRUeXBlLCByb3dJbmRleCwgY29sdW1uLmNvbHVtbktleSksXG4gICAgICAgIG9uS2V5RG93bjogZnVuY3Rpb25zLm9uQ2VsbEtleURvd24ocm93SW5kZXgsIGNvbCksXG4gICAgICAgIHJlZjogZnVuY3Rpb25zLmhhbmRsZUNlbGxSZWYocm93SW5kZXgsIGNvbCksXG4gICAgICAgIHN0eWxlOiBjb2x1bW4uc3R5bGUsXG4gICAgICB9LFxuICAgICAgY3VycmVuY3k6IGdyaWREYXRhLmdldEluKFtyb3dJbmRleCwgLi4uZ2V0Q3VycmVuY3lLZXlQYXRoKGNvbCldKVxuICAgICAgICB8fCAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLmN1cnJlbmN5KSxcbiAgICAgIGRlY2ltYWxTZXBhcmF0b3I6IChjb2wudmFsdWVPcHRpb25zICYmIGNvbC52YWx1ZU9wdGlvbnMuZGVjaW1hbFNlcGFyYXRvcikgfHwgZGVjaW1hbFNlcGFyYXRvcixcbiAgICAgIHRob3VzYW5kU2VwYXJhdG9yOiAoY29sLnZhbHVlT3B0aW9ucyAmJiBjb2wudmFsdWVPcHRpb25zLnRob3VzYW5kU2VwYXJhdG9yKVxuICAgICAgICB8fCB0aG91c2FuZFNlcGFyYXRvcixcbiAgICAgIGRlY2ltYWxzOiBjb2wudmFsdWVPcHRpb25zICYmIGNvbC52YWx1ZU9wdGlvbnMuZGVjaW1hbHMsXG4gICAgICB0YWJJbmRleCxcbiAgICAgIG9uQmx1cjogZnVuY3Rpb25zLm9uQ2VsbEJsdXIocm93SW5kZXgsIGNvbCksXG4gICAgICAuLi5jb2wuY3JlYXRlQ29tcG9uZW50UHJvcHMsXG4gICAgfTtcblxuICAgIHJldHVybiBpbnB1dFJlbmRlcih7IC4uLnByb3BzIH0pO1xuICB9LFxuICAvLyBDZWxsIGZpbHRlcmluZyBpcyBoYW5kbGVkIGJ5IHByaW1pdGl2ZS1yZW5kZXJlcnMgY2VsbEZpbHRlciBmdW5jdGlvblxuICAvLyBDaGVjayBjb2x1bW4tc2VydmljZS5qc3hcbn07XG4iXX0=