"use strict";

exports.__esModule = true;
exports["default"] = exports.dateRender = void 0;

var _react = _interopRequireDefault(require("react"));

var _moment = _interopRequireDefault(require("moment"));

var _reactIntl = require("react-intl");

var _reactDatetime = require("@opuscapita/react-datetime");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var dateRender = function dateRender(dateProps) {
  return /*#__PURE__*/_react["default"].createElement(_reactDatetime.DateInput, dateProps);
};

exports.dateRender = dateRender;

var dateIsValid = function dateIsValid(val) {
  return (0, _moment["default"])(val).isValid();
};

var dateIsValidFormat = function dateIsValidFormat(val, dateFormat) {
  return (0, _moment["default"])(val, dateFormat, true).isValid();
};

var className = 'oc-data-grid-date';
var _default = {
  // dateValueRender
  valRender: function valRender(rowIndex, dateFormat, valueRender) {
    return valueRender(rowIndex, function (v) {
      if (dateIsValidFormat(v, dateFormat)) {
        return _moment["default"].utc(v, dateFormat).format(dateFormat);
      }

      if (dateIsValid(v)) {
        return _moment["default"].utc(v).format(dateFormat);
      }

      return /*#__PURE__*/_react["default"].createElement(_reactIntl.FormattedMessage, {
        id: "Grid.InvalidDate"
      });
    });
  },
  // dateCellEdit
  cellEdit: function cellEdit(col, column, rowIndex, tabIndex, gridId, region, dateFormat, valueParser, functions, getComponentDisabledState) {
    var cellName = 'edit';

    var dateProps = _extends({
      className: className,
      dateFormat: dateFormat,
      locale: region,
      value: functions.getItemValue(rowIndex, col),
      onChange: functions.onCellValueChange(rowIndex, col, valueParser),
      inputRef: functions.handleCellRef(rowIndex, col),
      inputProps: {
        tabIndex: tabIndex,
        id: "ocDatagridEditInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        onKeyDown: functions.onCellKeyDown(rowIndex, col),
        onBlur: functions.onCellBlur(rowIndex, col),
        onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
        style: column.style
      },
      disabled: getComponentDisabledState(rowIndex, col, cellName)
    }, col.editComponentProps);

    return dateRender(_extends({}, dateProps));
  },
  // dateCellCreate
  cellCreate: function cellCreate(col, column, rowIndex, tabIndex, gridId, region, dateFormat, valueParser, functions, getComponentDisabledState) {
    var cellName = 'create';

    var dateProps = _extends({
      className: className,
      dateFormat: dateFormat,
      locale: region,
      value: functions.getItemValue(rowIndex, col),
      onChange: functions.onCellValueChange(rowIndex, col, valueParser),
      inputRef: functions.handleCellRef(rowIndex, col),
      inputProps: {
        tabIndex: tabIndex,
        id: "ocDatagridCreateInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
        onKeyDown: functions.onCellKeyDown(rowIndex, col),
        onBlur: functions.onCellBlur(rowIndex, col),
        onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
        style: column.style
      },
      disabled: getComponentDisabledState(rowIndex, col, cellName)
    }, col.createComponentProps);

    return dateRender(_extends({}, dateProps));
  },
  // dateFilterCell
  cellFilter: function cellFilter(col, column, tabIndex, gridId, region, dateFormat, valueParser, functions) {
    var dateProps = _extends({
      className: className,
      dateFormat: dateFormat,
      value: functions.getItemValue(col),
      onChange: functions.onCellValueChange(col, valueParser),
      locale: region,
      inputProps: {
        tabIndex: tabIndex,
        id: "ocDatagridFilterInput-" + gridId + "-" + column.columnKey,
        style: column.style
      }
    }, col.filterComponentProps);

    return dateRender(_extends({}, dateProps));
  }
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYXRhZ3JpZC9jb2x1bW4tc2VydmljZS9jb2x1bW4tdHlwZXMvZGF0ZS1yZW5kZXJlcnMuanN4Il0sIm5hbWVzIjpbImRhdGVSZW5kZXIiLCJkYXRlUHJvcHMiLCJkYXRlSXNWYWxpZCIsInZhbCIsImlzVmFsaWQiLCJkYXRlSXNWYWxpZEZvcm1hdCIsImRhdGVGb3JtYXQiLCJjbGFzc05hbWUiLCJ2YWxSZW5kZXIiLCJyb3dJbmRleCIsInZhbHVlUmVuZGVyIiwidiIsIm1vbWVudCIsInV0YyIsImZvcm1hdCIsImNlbGxFZGl0IiwiY29sIiwiY29sdW1uIiwidGFiSW5kZXgiLCJncmlkSWQiLCJyZWdpb24iLCJ2YWx1ZVBhcnNlciIsImZ1bmN0aW9ucyIsImdldENvbXBvbmVudERpc2FibGVkU3RhdGUiLCJjZWxsTmFtZSIsImxvY2FsZSIsInZhbHVlIiwiZ2V0SXRlbVZhbHVlIiwib25DaGFuZ2UiLCJvbkNlbGxWYWx1ZUNoYW5nZSIsImlucHV0UmVmIiwiaGFuZGxlQ2VsbFJlZiIsImlucHV0UHJvcHMiLCJpZCIsImNvbHVtbktleSIsIm9uS2V5RG93biIsIm9uQ2VsbEtleURvd24iLCJvbkJsdXIiLCJvbkNlbGxCbHVyIiwib25Gb2N1cyIsIm9uQ2VsbEZvY3VzIiwiY29tcG9uZW50VHlwZSIsInN0eWxlIiwiZGlzYWJsZWQiLCJlZGl0Q29tcG9uZW50UHJvcHMiLCJjZWxsQ3JlYXRlIiwiY3JlYXRlQ29tcG9uZW50UHJvcHMiLCJjZWxsRmlsdGVyIiwiZmlsdGVyQ29tcG9uZW50UHJvcHMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7OztBQUVPLElBQU1BLFVBQVUsR0FBRyxTQUFiQSxVQUFhLENBQUFDLFNBQVM7QUFBQSxzQkFBSSxnQ0FBQyx3QkFBRCxFQUFlQSxTQUFmLENBQUo7QUFBQSxDQUE1Qjs7OztBQUVQLElBQU1DLFdBQVcsR0FBRyxTQUFkQSxXQUFjLENBQUFDLEdB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TSxDQUFDeUI7QUFOSixPQVBDO0FBZWJDLE1BQUFBLFFBQVEsRUFBRXBCLHlCQUF5QixDQUFDZCxRQUFELEVBQVdPLEdBQVgsRUFBZ0JRLFFBQWhCO0FBZnRCLE9BZ0JWUixHQUFHLENBQUM4QixvQkFoQk0sQ0FBZjs7QUFrQkEsV0FBTzlDLFVBQVUsY0FBTUMsU0FBTixFQUFqQjtBQUNELEdBaEZZO0FBaUZiO0FBQ0E4QyxFQUFBQSxVQWxGYSxzQkFrRkYvQixHQWxGRSxFQWtGR0MsTUFsRkgsRUFrRldDLFFBbEZYLEVBa0ZxQkMsTUFsRnJCLEVBa0Y2QkMsTUFsRjdCLEVBa0ZxQ2QsVUFsRnJDLEVBa0ZpRGUsV0FsRmpELEVBa0Y4REMsU0FsRjlELEVBa0Z5RTtBQUNwRixRQUFNckIsU0FBUztBQUNiTSxNQUFBQSxTQUFTLEVBQVRBLFNBRGE7QUFFYkQsTUFBQUEsVUFBVSxFQUFWQSxVQUZhO0FBR2JvQixNQUFBQSxLQUFLLEVBQUVKLFNBQVMsQ0FBQ0ssWUFBVixDQUF1QlgsR0FBdkIsQ0FITTtBQUliWSxNQUFBQSxRQUFRLEVBQUVOLFNBQVMsQ0FBQ08saUJBQVYsQ0FBNEJiLEdBQTVCLEVBQWlDSyxXQUFqQyxDQUpHO0FBS2JJLE1BQUFBLE1BQU0sRUFBRUwsTUFMSztBQU1iWSxNQUFBQSxVQUFVLEVBQUU7QUFDVmQsUUFBQUEsUUFBUSxFQUFSQSxRQURVO0FBRVZlLFFBQUFBLEVBQUUsNkJBQTJCZCxNQUEzQixTQUFxQ0YsTUFBTSxDQUFDaUIsU0FGcEM7QUFHVlEsUUFBQUEsS0FBSyxFQUFFekIsTUFBTSxDQUFDeUI7QUFISjtBQU5DLE9BV1YxQixHQUFHLENBQUNnQyxvQkFYTSxDQUFmOztBQWFBLFdBQU9oRCxVQUFVLGNBQU1DLFNBQU4sRUFBakI7QUFDRDtBQWpHWSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IEZvcm1hdHRlZE1lc3NhZ2UgYXMgTSB9IGZyb20gJ3JlYWN0LWludGwnO1xuaW1wb3J0IHsgRGF0ZUlucHV0IH0gZnJvbSAnQG9wdXNjYXBpdGEvcmVhY3QtZGF0ZXRpbWUnO1xuXG5leHBvcnQgY29uc3QgZGF0ZVJlbmRlciA9IGRhdGVQcm9wcyA9PiA8RGF0ZUlucHV0IHsuLi5kYXRlUHJvcHN9IC8+O1xuXG5jb25zdCBkYXRlSXNWYWxpZCA9IHZhbCA9PiBtb21lbnQodmFsKS5pc1ZhbGlkKCk7XG5cbmNvbnN0IGRhdGVJc1ZhbGlkRm9ybWF0ID0gKHZhbCwgZGF0ZUZvcm1hdCkgPT4gbW9tZW50KHZhbCwgZGF0ZUZvcm1hdCwgdHJ1ZSkuaXNWYWxpZCgpO1xuXG5jb25zdCBjbGFzc05hbWUgPSAnb2MtZGF0YS1ncmlkLWRhdGUnO1xuXG5leHBvcnQgZGVmYXVsdCB7XG4gIC8vIGRhdGVWYWx1ZVJlbmRlclxuICB2YWxSZW5kZXIocm93SW5kZXgsIGRhdGVGb3JtYXQsIHZhbHVlUmVuZGVyKSB7XG4gICAgcmV0dXJuIHZhbHVlUmVuZGVyKHJvd0luZGV4LCAodikgPT4ge1xuICAgICAgaWYgKGRhdGVJc1ZhbGlkRm9ybWF0KHYsIGRhdGVGb3JtYXQpKSB7XG4gICAgICAgIHJldHVybiBtb21lbnQudXRjKHYsIGRhdGVGb3JtYXQpLmZvcm1hdChkYXRlRm9ybWF0KTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRlSXNWYWxpZCh2KSkge1xuICAgICAgICByZXR1cm4gbW9tZW50LnV0Yyh2KS5mb3JtYXQoZGF0ZUZvcm1hdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gPE0gaWQ9XCJHcmlkLkludmFsaWREYXRlXCIgLz47XG4gICAgfSk7XG4gIH0sXG4gIC8vIGRhdGVDZWxsRWRpdFxuICBjZWxsRWRpdChcbiAgICBjb2wsXG4gICAgY29sdW1uLFxuICAgIHJvd0luZGV4LFxuICAgIHRhYkluZGV4LFxuICAgIGdyaWRJZCxcbiAgICByZWdpb24sXG4gICAgZGF0ZUZvcm1hdCxcbiAgICB2YWx1ZVBhcnNlcixcbiAgICBmdW5jdGlvbnMsXG4gICAgZ2V0Q29tcG9uZW50RGlzYWJsZWRTdGF0ZSxcbiAgKSB7XG4gICAgY29uc3QgY2VsbE5hbWUgPSAnZWRpdCc7XG4gICAgY29uc3QgZGF0ZVByb3BzID0ge1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgZGF0ZUZvcm1hdCxcbiAgICAgIGxvY2FsZTogcmVnaW9uLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9ucy5nZXRJdGVtVmFsdWUocm93SW5kZXgsIGNvbCksXG4gICAgICBvbkNoYW5nZTogZnVuY3Rpb25zLm9uQ2VsbFZhbHVlQ2hhbmdlKHJvd0luZGV4LCBjb2wsIHZhbHVlUGFyc2VyKSxcbiAgICAgIGlucHV0UmVmOiBmdW5jdGlvbnMuaGFuZGxlQ2VsbFJlZihyb3dJbmRleCwgY29sKSxcbiAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgdGFiSW5kZXgsXG4gICAgICAgIGlkOiBgb2NEYXRhZ3JpZEVkaXRJbnB1dC0ke2dyaWRJZH0tJHtjb2x1bW4uY29sdW1uS2V5fS0ke3Jvd0luZGV4fWAsXG4gICAgICAgIG9uS2V5RG93bjogZnVuY3Rpb25zLm9uQ2VsbEtleURvd24ocm93SW5kZXgsIGNvbCksXG4gICAgICAgIG9uQmx1cjogZnVuY3Rpb25zLm9uQ2VsbEJsdXIocm93SW5kZXgsIGNvbCksXG4gICAgICAgIG9uRm9jdXM6IGZ1bmN0aW9ucy5vbkNlbGxGb2N1cyhjZWxsTmFtZSwgY29sLmNvbXBvbmVudFR5cGUsIHJvd0luZGV4LCBjb2x1bW4uY29sdW1uS2V5KSxcbiAgICAgICAgc3R5bGU6IGNvbHVtbi5zdHlsZSxcbiAgICAgIH0sXG4gICAgICBkaXNhYmxlZDogZ2V0Q29tcG9uZW50RGlzYWJsZWRTdGF0ZShyb3dJbmRleCwgY29sLCBjZWxsTmFtZSksXG4gICAgICAuLi5jb2wuZWRpdENvbXBvbmVudFByb3BzLFxuICAgIH07XG4gICAgcmV0dXJuIGRhdGVSZW5kZXIoeyAuLi5kYXRlUHJvcHMgfSk7XG4gIH0sXG4gIC8vIGRhdGVDZWxsQ3JlYXRlXG4gIGNlbGxDcmVhdGUoXG4gICAgY29sLFxuICAgIGNvbHVtbixcbiAgICByb3dJbmRleCxcbiAgICB0YWJJbmRleCxcbiAgICBncmlkSWQsXG4gICAgcmVnaW9uLFxuICAgIGRhdGVGb3JtYXQsXG4gICAgdmFsdWVQYXJzZXIsXG4gICAgZnVuY3Rpb25zLFxuICAgIGdldENvbXBvbmVudERpc2FibGVkU3RhdGUsXG4gICkge1xuICAgIGNvbnN0IGNlbGxOYW1lID0gJ2NyZWF0ZSc7XG4gICAgY29uc3QgZGF0ZVByb3BzID0ge1xuICAgICAgY2xhc3NOYW1lLFxuICAgICAgZGF0ZUZvcm1hdCxcbiAgICAgIGxvY2FsZTogcmVnaW9uLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9ucy5nZXRJdGVtVmFsdWUocm93SW5kZXgsIGNvbCksXG4gICAgICBvbkNoYW5nZTogZnVuY3Rpb25zLm9uQ2VsbFZhbHVlQ2hhbmdlKHJvd0luZGV4LCBjb2wsIHZhbHVlUGFyc2VyKSxcbiAgICAgIGlucHV0UmVmOiBmdW5jdGlvbnMuaGFuZGxlQ2VsbFJlZihyb3dJbmRleCwgY29sKSxcbiAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgdGFiSW5kZXgsXG4gICAgICAgIGlkOiBgb2NEYXRhZ3JpZENyZWF0ZUlucHV0LSR7Z3JpZElkfS0ke2NvbHVtbi5jb2x1bW5LZXl9LSR7cm93SW5kZXh9YCxcbiAgICAgICAgb25LZXlEb3duOiBmdW5jdGlvbnMub25DZWxsS2V5RG93bihyb3dJbmRleCwgY29sKSxcbiAgICAgICAgb25CbHVyOiBmdW5jdGlvbnMub25DZWxsQmx1cihyb3dJbmRleCwgY29sKSxcbiAgICAgICAgb25Gb2N1czogZnVuY3Rpb25zLm9uQ2VsbEZvY3VzKGNlbGxOYW1lLCBjb2wuY29tcG9uZW50VHlwZSwgcm93SW5kZXgsIGNvbHVtbi5jb2x1bW5LZXkpLFxuICAgICAgICBzdHlsZTogY29sdW1uLnN0eWxlLFxuICAgICAgfSxcbiAgICAgIGRpc2FibGVkOiBnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlKHJvd0luZGV4LCBjb2wsIGNlbGxOYW1lKSxcbiAgICAgIC4uLmNvbC5jcmVhdGVDb21wb25lbnRQcm9wcyxcbiAgICB9O1xuICAgIHJldHVybiBkYXRlUmVuZGVyKHsgLi4uZGF0ZVByb3BzIH0pO1xuICB9LFxuICAvLyBkYXRlRmlsdGVyQ2VsbFxuICBjZWxsRmlsdGVyKGNvbCwgY29sdW1uLCB0YWJJbmRleCwgZ3JpZElkLCByZWdpb24sIGRhdGVGb3JtYXQsIHZhbHVlUGFyc2VyLCBmdW5jdGlvbnMpIHtcbiAgICBjb25zdCBkYXRlUHJvcHMgPSB7XG4gICAgICBjbGFzc05hbWUsXG4gICAgICBkYXRlRm9ybWF0LFxuICAgICAgdmFsdWU6IGZ1bmN0aW9ucy5nZXRJdGVtVmFsdWUoY29sKSxcbiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbnMub25DZWxsVmFsdWVDaGFuZ2UoY29sLCB2YWx1ZVBhcnNlciksXG4gICAgICBsb2NhbGU6IHJlZ2lvbixcbiAgICAgIGlucHV0UHJvcHM6IHtcbiAgICAgICAgdGFiSW5kZXgsXG4gICAgICAgIGlkOiBgb2NEYXRhZ3JpZEZpbHRlcklucHV0LSR7Z3JpZElkfS0ke2NvbHVtbi5jb2x1bW5LZXl9YCxcbiAgICAgICAgc3R5bGU6IGNvbHVtbi5zdHlsZSxcbiAgICAgIH0sXG4gICAgICAuLi5jb2wuZmlsdGVyQ29tcG9uZW50UHJvcHMsXG4gICAgfTtcbiAgICByZXR1cm4gZGF0ZVJlbmRlcih7IC4uLmRhdGVQcm9wcyB9KTtcbiAgfSxcbn07XG4iXX0=