"use strict";

exports.__esModule = true;
exports["default"] = exports.creatableSelectRender = exports.selectRender = void 0;

var _react = _interopRequireDefault(require("react"));

var _reactFloatingSelect = require("@opuscapita/react-floating-select");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

var selectRender = function selectRender(selectProps) {
  return _react["default"].createElement(_reactFloatingSelect.FloatingSelectPortal, selectProps);
};

exports.selectRender = selectRender;

var creatableSelectRender = function creatableSelectRender(selectProps) {
  return _react["default"].createElement(_reactFloatingSelect.FloatingSelectPortalCreatable, selectProps);
};

exports.creatableSelectRender = creatableSelectRender;
var _default = {
  cellEdit: function cellEdit(col, column, rowIndex, tabIndex, gridId, selectOptions, selectTranslations, editValueParser, functions, getComponentDisabledState) {
    var cellName = 'edit';
    var opts = col.editSelectOptionsMod && selectOptions ? col.editSelectOptionsMod(selectOptions.slice(), rowIndex, col) : selectOptions;

    var fsProps = _extends({
      name: "ocDatagridEditInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
      options: opts,
      value: functions.getItemValue(rowIndex, col, {
        selectOptions: selectOptions
      }),
      onChange: functions.onCellValueChange(rowIndex, col, editValueParser),
      onBlur: functions.onCellBlur(rowIndex, col),
      onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
      onKeyDown: functions.onCellKeyDown(rowIndex, col),
      isSearchable: selectOptions && selectOptions.length > 9,
      isClearable: !col.isRequired,
      backSpaceRemovesValue: false,
      tabSelectsValue: false,
      openMenuOnFocus: false,
      ref: functions.handleCellRef(rowIndex, col),
      isDisabled: getComponentDisabledState(rowIndex, col, cellName),
      tabIndex: tabIndex
    }, col.editComponentProps, selectTranslations);

    if (col.isCreatableSelect) return creatableSelectRender(_extends({}, fsProps));
    return selectRender(_extends({}, fsProps));
  },
  cellCreate: function cellCreate(col, column, rowIndex, tabIndex, gridId, selectOptions, selectTranslations, editValueParser, functions, getComponentDisabledState) {
    var cellName = 'create';
    var opts = col.createSelectOptionsMod && selectOptions ? col.createSelectOptionsMod(selectOptions.slice(), rowIndex, col) : selectOptions;

    var fsProps = _extends({
      name: "ocDatagridCreateInput-" + gridId + "-" + column.columnKey + "-" + rowIndex,
      options: opts,
      value: functions.getItemValue(rowIndex, col, {
        selectOptions: selectOptions
      }),
      onChange: functions.onCellValueChange(rowIndex, col, editValueParser),
      onBlur: functions.onCellBlur(rowIndex, col),
      onKeyDown: functions.onCellKeyDown(rowIndex, col),
      onFocus: functions.onCellFocus(cellName, col.componentType, rowIndex, column.columnKey),
      isSearchable: selectOptions && selectOptions.length > 9,
      isClearable: !col.isRequired,
      backspaceRemovesValue: false,
      tabSelectsValue: false,
      openMenuOnFocus: false,
      ref: functions.handleCellRef(rowIndex, col),
      isDisabled: getComponentDisabledState(rowIndex, col, cellName),
      tabIndex: tabIndex
    }, col.createComponentProps, selectTranslations);

    if (col.isCreatableSelect) return creatableSelectRender(_extends({}, fsProps));
    return selectRender(_extends({}, fsProps));
  },
  cellFilter: function cellFilter(col, column, tabIndex, gridId, selectOptions, selectTranslations, editValueParser, functions) {
    var opts = col.filterSelectOptionsMod && selectOptions ? col.filterSelectOptionsMod(selectOptions.slice(), col) : selectOptions;

    var fsProps = _extends({
      name: "ocDatagridFilterInput-" + gridId + "-" + column.columnKey,
      options: opts,
      value: functions.getItemValue(col, {
        selectOptions: selectOptions
      }),
      onChange: functions.onCellValueChange(col, editValueParser),
      isSearchable: selectOptions && selectOptions.length > 9,
      isClearable: true,
      tabSelectsValue: false,
      tabIndex: tabIndex
    }, col.filterComponentProps, selectTranslations);

    return selectRender(_extends({}, fsProps));
  }
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9kYXRhZ3JpZC9jb2x1bW4tc2VydmljZS9jb2x1bW4tdHlwZXMvc2VsZWN0LXJlbmRlcmVycy5qc3giXSwibmFtZXMiOlsic2VsZWN0UmVuZGVyIiwic2VsZWN0UHJvcHMiLCJjcmVhdGFibGVTZWxlY3RSZW5kZXIiLCJjZWxsRWRpdCIsImNvbCIsImNvbHVtbiIsInJvd0luZGV4IiwidGFiSW5kZXgiLCJncmlkSWQiLCJzZWxlY3RPcHRpb25zIiwic2VsZWN0VHJhbnNsYXRpb25zIiwiZWRpdFZhbHVlUGFyc2VyIiwiZnVuY3Rpb25zIiwiZ2V0Q29tcG9uZW50RGlzYWJsZWRTdGF0ZSIsImNlbGxOYW1lIiwib3B0cyIsImVkaXRTZWxlY3RPcHRpb25zTW9kIiwic2xpY2UiLCJmc1Byb3BzIiwibmFtZSIsImNvbHVtbktleSIsIm9wdGlvbnMiLCJ2YWx1ZSIsImdldEl0ZW1WYWx1ZSIsIm9uQ2hhbmdlIiwib25DZWxsVmFsdWVDaGFuZ2UiLCJvbkJsdXIiLCJvbkNlbGxCbHVyIiwib25Gb2N1cyIsIm9uQ2VsbEZvY3VzIiwiY29tcG9uZW50VHlwZSIsIm9uS2V5RG93biIsIm9uQ2VsbEtleURvd24iLCJpc1NlYXJjaGFibGUiLCJsZW5ndGgiLCJpc0NsZWFyYWJsZSIsImlzUmVxdWlyZWQiLCJiYWNrU3BhY2VSZW1vdmVzVmFsdWUiLCJ0YWJTZWxlY3RzVmFsdWUiLCJvcGVuTWVudU9uRm9jdXMiLCJyZWYiLCJoYW5kbGVDZWxsUmVmIiwiaXNEaXNhYmxlZCIsImVkaXRDb21wb25lbnRQcm9wcyIsImlzQ3JlYXRhYmxlU2VsZWN0IiwiY2VsbENyZWF0ZSIsImNyZWF0ZVNlbGVjdE9wdGlvbnNNb2QiLCJiYWNrc3BhY2VSZW1vdmVzVmFsdWUiLCJjcmVhdGVDb21wb25lbnRQcm9wcyIsImNlbGxGaWx0ZXIiLCJmaWx0ZXJTZWxlY3RPcHRpb25zTW9kIiwiZmlsdGVyQ29tcG9uZW50UHJvcHMiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7O0FBQ0E7Ozs7OztBQUtPLElBQU1BLFlBQVksR0FBRyxTQUFmQSxZQUFlLENBQUFDLFdBQVc7QUFBQSxTQUFJLGdDQUFDLHlDQUFELEVBQTBCQSxXQUExQixDQUFKO0FBQUEsQ0FBaEM7Ozs7QUFFQSxJQUFNQyxxQkFBcUIsR0FBRyxTQUF4QkEscUJBQXdCLENBQUFELFdBQVc7QUFBQSxTQUM5QyxnQ0FBQyxrREFBRCxFQUFtQ0EsV0FBbkMsQ0FEOEM7QUFBQSxDQUF6Qzs7O2VBSVE7QUFDYkUsRUFBQUEsUUFEYSxvQkFFWEMsR0FGVyxFQUdYQyxNQUhXLEVBSVhDLFFBSlcsRUFLWEMsUUFMVyxFQU1YQyxNQU5XLEVBT1hDLGFBUFcsRUFRWEMsa0JBUlcsRUFTWEMsZUFUVyxFQVVYQyxTQVZXLEVBV1hDLHlCQVhXLEVBWVg7QUFDQSxRQUFNQyxRQUFRLEdBQUcsTUFBakI7QUFDQSxRQUFNQyxJQUFJLEdBQUdYLEdBQUcsQ0FBQ1ksb0JBQUosSUFBNEJQLGFBQTVCLEdBQ1RMLEdBQUcsQ0FBQ1ksb0JBQUosQ0FBeUJQLGFBQWEsQ0FBQ1EsS0FBZCxFQUF6QixFQUFnRFgsUUFBaEQsRUFBMERGLEdBQTFELENBRFMsR0FFVEssYUFGSjs7QUFHQSxRQUFNUyxPQUFPO0FBQ1hDLE1BQUFBLElBQUksMkJBQXlCWCxNQUF6QixTQUFtQ0gsTUFBTSxDQUFDZSxTQUExQyxTQUF1RGQsUUFEaEQ7QUFFWGUsTUFBQUEsT0FBTyxFQUFFTixJQUZFO0FBR1hPLE1BQUFBLEtBQUssRUFBRVYsU0FBUyxDQUFDVyxZQUFWLENBQXVCakIsUUFBdkIsRUFBaUNGLEdBQWpDLEVBQXNDO0FBQUVLLFFBQUFBLGFBQWEsRUFBYkE7QUFBRixPQUF0QyxDQUhJO0FBSVhlLE1BQUFBLFFBQVEsRUFBRVosU0FBUyxDQUFDYSxpQkFBVixDQUE0Qm5CLFFBQTVCLEVBQXNDRixHQUF0QyxFQUEyQ08sZUFBM0MsQ0FKQztBQUtYZSxNQUFBQSxNQUFNLEVBQUVkLFNBQVMsQ0FBQ2UsVUFBVixDQUFxQnJCLFFBQXJCLEVBQStCRixHQUEvQixDQUxHO0FBTVh3QixNQUFBQSxPQUFPLEVBQUVoQixTQUFTLENBQUNpQixXQUFWLENBQXNCZixRQUF0QixFQUFnQ1YsR0FBRyxDQUFDMEIsYUFBcEMsRUFBbUR4QixRQUFuRCxFQUE2REQsTUFBTSxDQUFDZSxTQUFwRSxDQU5FO0FBT1hXLE1BQUFBLFNBQVMsRUFBRW5CLFNBQVMsQ0FBQ29CLGFBQVYsQ0FBd0IxQixRQUF4QixFQUFrQ0YsR0FBbEMsQ0FQQTtBQVFYNkIsTUFBQUEsWUFBWSxFQUFFeEIsYUFBYSxJQUFJQSxhQUFhLENBQUN5QixNQUFkLEdBQXVCLENBUjNDO0FBU1hDLE1BQUFBLFdBQVcsRUFBRSxDQUFDL0IsR0FBRyxDQUFDZ0MsVUFUUDtBQVVYQyxNQUFBQSxxQkFBcUIsRUFBRSxLQVZaO0FBV1hDLE1BQUFBLGVBQWUsRUFBRSxLQVhOO0FBWVhDLE1BQUFBLGVBQWUsRUFBRSxLQVpOO0FBYVhDLE1BQUFBLEdBQUcsRUFBRTVCLFNBQVMsQ0FBQzZCLGFBQVYsQ0FBd0JuQyxRQUF4QixFQUFrQ0YsR0FBbEMsQ0FiTTtBQWNYc0MsTUFBQUEsVUFBVSxFQUFFN0IseUJBQXlCLENBQUNQLFFBQUQsRUFBV0YsR0FBWCxFQUFnQlUsUUFBaEIsQ0FkMUI7QUFlWFAsTUFBQUEsUUFBUSxFQUFSQTtBQWZXLE9BZ0JSSCxHQUFHLENBQUN1QyxrQkFoQkksRUFpQlJqQyxrQkFqQlEsQ0FBYjs7QUFvQkEsUUFBSU4sR0FBRyxDQUFDd0MsaUJBQVIsRUFBMkIsT0FBTzFDLHFCQUFxQixjQUFNZ0IsT0FBTixFQUE1QjtBQUMzQixXQUFPbEIsWUFBWSxjQUFNa0IsT0FBTixFQUFuQjtBQUNELEdBdkNZO0FBeUNiMkIsRUFBQUEsVUF6Q2Esc0JBMENYekMsR0ExQ1csRUEyQ1hDLE1BM0NXLEVBNENYQyxRQTVDVyxFQTZDWEMsUUE3Q1csRUE4Q1hDLE1BOUNXLEVBK0NYQyxhQS9DVyxFQWdEWEMsa0JBaERXLEVBaURYQyxlQWpEVyxFQWtEWEMsU0FsRFcsRUFtRFhDLHlCQW5EVyxFQW9EWDtBQUNBLFFBQU1DLFFBQVEsR0FBRyxRQUFqQjtBQUNBLFFBQU1DLElBQUksR0FBR1gsR0FBRyxDQUFDMEMsc0JBQUosSUFBOEJyQyxhQUE5QixHQUNUTCxHQUFHLENBQUMwQyxzQkFBSixDQUEyQnJDLGFBQWEsQ0FBQ1EsS0FBZCxFQUEzQixFQUFrRFgsUUFBbEQsRUFBNERGLEdBQTVELENBRFMsR0FFVEssYUFGSjs7QUFHQSxRQUFNUyxPQUFPO0FBQ1hDLE1BQUFBLElBQUksNkJBQTJCWCxNQUEzQixTQUFxQ0gsTUFBTSxDQUFDZSxTQUE1QyxTQUF5RGQsUUFEbEQ7QUFFWGUsTUFBQUEsT0FBTyxFQUFFTixJQUZFO0FBR1hPLE1BQUFBLEtBQUssRUFBRVYsU0FBUyxDQUFDVyxZQUFWLENBQXVCakIsUUFBdkIsRUFBaUNGLEdBQWpDLEVBQXNDO0FBQUVLLFFBQUFBLGFBQWEsRUFBYkE7QUFBRixPQUF0QyxDQUhJO0FBSVhlLE1BQUFBLFFBQVEsRUFBRVosU0FBUyxDQUFDYSxpQkFBVixDQUE0Qm5CLFFBQTVCLEVBQXNDRixHQUF0QyxFQUEyQ08sZUFBM0MsQ0FKQztBQUtYZSxNQUFBQSxNQUFNLEVBQUVkLFNBQVMsQ0FBQ2UsVUFBVixDQUFxQnJCLFFBQXJCLEVBQStCRixHQUEvQixDQUxHO0FBTVgyQixNQUFBQSxTQUFTLEVBQUVuQixTQUFTLENBQUNvQixhQUFWLENBQXdCMUIsUUFBeEIsRUFBa0NGLEdBQWxDLENBTkE7QUFPWHdCLE1BQUFBLE9BQU8sRUFBRWhCLFNBQVMsQ0FBQ2lCLFdBQVYsQ0FBc0JmLFFBQXRCLEVBQWdDVixHQUFHLENBQUMwQixhQUFwQyxFQUFtRHhCLFFBQW5ELEVBQTZERCxNQUFNLENBQUNlLFNBQXBFLENBUEU7QUFRWGEsTUFBQUEsWUFBWSxFQUFFeEIsYUFBYSxJQUFJQSxhQUFhLENBQUN5QixNQUFkLEdBQXVCLENBUjNDO0FBU1hDLE1BQUFBLFdBQVcsRUFBRSxDQUFDL0IsR0FBRyxDQUFDZ0MsVUFUUDtBQVVYVyxNQUFBQSxxQkFBcUIsRUFBRSxLQVZaO0FBV1hULE1BQUFBLGVBQWUsRUFBRSxLQVhOO0FBWVhDLE1BQUFBLGVBQWUsRUFBRSxLQVpOO0FBYVhDLE1BQUFBLEdBQUcsRUFBRTVCLFNBQVMsQ0FBQzZCLGFBQVYsQ0FBd0JuQyxRQUF4QixFQUFrQ0YsR0FBbEMsQ0FiTTtBQWNYc0MsTUFBQUEsVUFBVSxFQUFFN0IseUJBQXlCLENBQUNQLFFBQUQsRUFBV0YsR0FBWCxFQUFnQlUsUUFBaEIsQ0FkMUI7QUFlWFAsTUFBQUEsUUFBUSxFQUFSQTtBQWZXLE9BZ0JSSCxHQUFHLENBQUM0QyxvQkFoQkksRUFpQlJ0QyxrQkFqQlEsQ0FBYjs7QUFvQkEsUUFBSU4sR0FBRyxDQUFDd0MsaUJBQVIsRUFBMkIsT0FBTzFDLHFCQUFxQixjQUFNZ0IsT0FBTixFQUE1QjtBQUMzQixXQUFPbEIsWUFBWSxjQUFNa0IsT0FBTixFQUFuQjtBQUNELEdBL0VZO0FBaUZiK0IsRUFBQUEsVUFqRmEsc0JBa0ZYN0MsR0FsRlcsRUFtRlhDLE1BbkZXLEVBb0ZYRSxRQXBGVyxFQXFGWEMsTUFyRlcsRUFzRlhDLGFBdEZXLEVBdUZYQyxrQkF2RlcsRUF3RlhDLGVBeEZXLEVBeUZYQyxTQXpGVyxFQTBGWDtBQUNBLFFBQU1HLElBQUksR0FBR1gsR0FBRyxDQUFDOEMsc0JBQUosSUFBOEJ6QyxhQUE5QixHQUNUTCxHQUFHLENBQUM4QyxzQkFBSixDQUEyQnpDLGFBQWEsQ0FBQ1EsS0FBZCxFQUEzQixFQUFrRGIsR0FBbEQsQ0FEUyxHQUVUSyxhQUZKOztBQUdBLFFBQU1TLE9BQU87QUFDWEMsTUFBQUEsSUFBSSw2QkFBMkJYLE1BQTNCLFNBQXFDSCxNQUFNLENBQUNlLFNBRHJDO0FBRVhDLE1BQUFBLE9BQU8sRUFBRU4sSUFGRTtBQUdYTyxNQUFBQSxLQUFLLEVBQUVWLFNBQVMsQ0FBQ1csWUFBVixDQUF1Qm5CLEdBQXZCLEVBQTRCO0FBQUVLLFFBQUFBLGFBQWEsRUFBYkE7QUFBRixPQUE1QixDQUhJO0FBSVhlLE1BQUFBLFFBQVEsRUFBRVosU0FBUyxDQUFDYSxpQkFBVixDQUE0QnJCLEdBQTVCLEVBQWlDTyxlQUFqQyxDQUpDO0FBS1hzQixNQUFBQSxZQUFZLEVBQUV4QixhQUFhLElBQUlBLGFBQWEsQ0FBQ3lCLE1BQWQsR0FBdUIsQ0FMM0M7QUFNWEMsTUFBQUEsV0FBVyxFQUFFLElBTkY7QUFPWEcsTUFBQUEsZUFBZSxFQUFFLEtBUE47QUFRWC9CLE1BQUFBLFFBQVEsRUFBUkE7QUFSVyxPQVNSSCxHQUFHLENBQUMrQyxvQkFUSSxFQVVSekMsa0JBVlEsQ0FBYjs7QUFhQSxXQUFPVixZQUFZLGNBQU1rQixPQUFOLEVBQW5CO0FBQ0Q7QUE1R1ksQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICBGbG9hdGluZ1NlbGVjdFBvcnRhbCxcbiAgRmxvYXRpbmdTZWxlY3RQb3J0YWxDcmVhdGFibGUsXG59IGZyb20gJ0BvcHVzY2FwaXRhL3JlYWN0LWZsb2F0aW5nLXNlbGVjdCc7XG5cbmV4cG9ydCBjb25zdCBzZWxlY3RSZW5kZXIgPSBzZWxlY3RQcm9wcyA9PiA8RmxvYXRpbmdTZWxlY3RQb3J0YWwgey4uLnNlbGVjdFByb3BzfSAvPjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0YWJsZVNlbGVjdFJlbmRlciA9IHNlbGVjdFByb3BzID0+IChcbiAgPEZsb2F0aW5nU2VsZWN0UG9ydGFsQ3JlYXRhYmxlIHsuLi5zZWxlY3RQcm9wc30gLz5cbik7XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgY2VsbEVkaXQoXG4gICAgY29sLFxuICAgIGNvbHVtbixcbiAgICByb3dJbmRleCxcbiAgICB0YWJJbmRleCxcbiAgICBncmlkSWQsXG4gICAgc2VsZWN0T3B0aW9ucyxcbiAgICBzZWxlY3RUcmFuc2xhdGlvbnMsXG4gICAgZWRpdFZhbHVlUGFyc2VyLFxuICAgIGZ1bmN0aW9ucyxcbiAgICBnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlLFxuICApIHtcbiAgICBjb25zdCBjZWxsTmFtZSA9ICdlZGl0JztcbiAgICBjb25zdCBvcHRzID0gY29sLmVkaXRTZWxlY3RPcHRpb25zTW9kICYmIHNlbGVjdE9wdGlvbnNcbiAgICAgID8gY29sLmVkaXRTZWxlY3RPcHRpb25zTW9kKHNlbGVjdE9wdGlvbnMuc2xpY2UoKSwgcm93SW5kZXgsIGNvbClcbiAgICAgIDogc2VsZWN0T3B0aW9ucztcbiAgICBjb25zdCBmc1Byb3BzID0ge1xuICAgICAgbmFtZTogYG9jRGF0YWdyaWRFZGl0SW5wdXQtJHtncmlkSWR9LSR7Y29sdW1uLmNvbHVtbktleX0tJHtyb3dJbmRleH1gLFxuICAgICAgb3B0aW9uczogb3B0cyxcbiAgICAgIHZhbHVlOiBmdW5jdGlvbnMuZ2V0SXRlbVZhbHVlKHJvd0luZGV4LCBjb2wsIHsgc2VsZWN0T3B0aW9ucyB9KSxcbiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbnMub25DZWxsVmFsdWVDaGFuZ2Uocm93SW5kZXgsIGNvbCwgZWRpdFZhbHVlUGFyc2VyKSxcbiAgICAgIG9uQmx1cjogZnVuY3Rpb25zLm9uQ2VsbEJsdXIocm93SW5kZXgsIGNvbCksXG4gICAgICBvbkZvY3VzOiBmdW5jdGlvbnMub25DZWxsRm9jdXMoY2VsbE5hbWUsIGNvbC5jb21wb25lbnRUeXBlLCByb3dJbmRleCwgY29sdW1uLmNvbHVtbktleSksXG4gICAgICBvbktleURvd246IGZ1bmN0aW9ucy5vbkNlbGxLZXlEb3duKHJvd0luZGV4LCBjb2wpLFxuICAgICAgaXNTZWFyY2hhYmxlOiBzZWxlY3RPcHRpb25zICYmIHNlbGVjdE9wdGlvbnMubGVuZ3RoID4gOSxcbiAgICAgIGlzQ2xlYXJhYmxlOiAhY29sLmlzUmVxdWlyZWQsXG4gICAgICBiYWNrU3BhY2VSZW1vdmVzVmFsdWU6IGZhbHNlLFxuICAgICAgdGFiU2VsZWN0c1ZhbHVlOiBmYWxzZSxcbiAgICAgIG9wZW5NZW51T25Gb2N1czogZmFsc2UsXG4gICAgICByZWY6IGZ1bmN0aW9ucy5oYW5kbGVDZWxsUmVmKHJvd0luZGV4LCBjb2wpLFxuICAgICAgaXNEaXNhYmxlZDogZ2V0Q29tcG9uZW50RGlzYWJsZWRTdGF0ZShyb3dJbmRleCwgY29sLCBjZWxsTmFtZSksXG4gICAgICB0YWJJbmRleCxcbiAgICAgIC4uLmNvbC5lZGl0Q29tcG9uZW50UHJvcHMsXG4gICAgICAuLi5zZWxlY3RUcmFuc2xhdGlvbnMsXG4gICAgfTtcblxuICAgIGlmIChjb2wuaXNDcmVhdGFibGVTZWxlY3QpIHJldHVybiBjcmVhdGFibGVTZWxlY3RSZW5kZXIoeyAuLi5mc1Byb3BzIH0pO1xuICAgIHJldHVybiBzZWxlY3RSZW5kZXIoeyAuLi5mc1Byb3BzIH0pO1xuICB9LFxuXG4gIGNlbGxDcmVhdGUoXG4gICAgY29sLFxuICAgIGNvbHVtbixcbiAgICByb3dJbmRleCxcbiAgICB0YWJJbmRleCxcbiAgICBncmlkSWQsXG4gICAgc2VsZWN0T3B0aW9ucyxcbiAgICBzZWxlY3RUcmFuc2xhdGlvbnMsXG4gICAgZWRpdFZhbHVlUGFyc2VyLFxuICAgIGZ1bmN0aW9ucyxcbiAgICBnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlLFxuICApIHtcbiAgICBjb25zdCBjZWxsTmFtZSA9ICdjcmVhdGUnO1xuICAgIGNvbnN0IG9wdHMgPSBjb2wuY3JlYXRlU2VsZWN0T3B0aW9uc01vZCAmJiBzZWxlY3RPcHRpb25zXG4gICAgICA/IGNvbC5jcmVhdGVTZWxlY3RPcHRpb25zTW9kKHNlbGVjdE9wdGlvbnMuc2xpY2UoKSwgcm93SW5kZXgsIGNvbClcbiAgICAgIDogc2VsZWN0T3B0aW9ucztcbiAgICBjb25zdCBmc1Byb3BzID0ge1xuICAgICAgbmFtZTogYG9jRGF0YWdyaWRDcmVhdGVJbnB1dC0ke2dyaWRJZH0tJHtjb2x1bW4uY29sdW1uS2V5fS0ke3Jvd0luZGV4fWAsXG4gICAgICBvcHRpb25zOiBvcHRzLFxuICAgICAgdmFsdWU6IGZ1bmN0aW9ucy5nZXRJdGVtVmFsdWUocm93SW5kZXgsIGNvbCwgeyBzZWxlY3RPcHRpb25zIH0pLFxuICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9ucy5vbkNlbGxWYWx1ZUNoYW5nZShyb3dJbmRleCwgY29sLCBlZGl0VmFsdWVQYXJzZXIpLFxuICAgICAgb25CbHVyOiBmdW5jdGlvbnMub25DZWxsQmx1cihyb3dJbmRleCwgY29sKSxcbiAgICAgIG9uS2V5RG93bjogZnVuY3Rpb25zLm9uQ2VsbEtleURvd24ocm93SW5kZXgsIGNvbCksXG4gICAgICBvbkZvY3VzOiBmdW5jdGlvbnMub25DZWxsRm9jdXMoY2VsbE5hbWUsIGNvbC5jb21wb25lbnRUeXBlLCByb3dJbmRleCwgY29sdW1uLmNvbHVtbktleSksXG4gICAgICBpc1NlYXJjaGFibGU6IHNlbGVjdE9wdGlvbnMgJiYgc2VsZWN0T3B0aW9ucy5sZW5ndGggPiA5LFxuICAgICAgaXNDbGVhcmFibGU6ICFjb2wuaXNSZXF1aXJlZCxcbiAgICAgIGJhY2tzcGFjZVJlbW92ZXNWYWx1ZTogZmFsc2UsXG4gICAgICB0YWJTZWxlY3RzVmFsdWU6IGZhbHNlLFxuICAgICAgb3Blbk1lbnVPbkZvY3VzOiBmYWxzZSxcbiAgICAgIHJlZjogZnVuY3Rpb25zLmhhbmRsZUNlbGxSZWYocm93SW5kZXgsIGNvbCksXG4gICAgICBpc0Rpc2FibGVkOiBnZXRDb21wb25lbnREaXNhYmxlZFN0YXRlKHJvd0luZGV4LCBjb2wsIGNlbGxOYW1lKSxcbiAgICAgIHRhYkluZGV4LFxuICAgICAgLi4uY29sLmNyZWF0ZUNvbXBvbmVudFByb3BzLFxuICAgICAgLi4uc2VsZWN0VHJhbnNsYXRpb25zLFxuICAgIH07XG5cbiAgICBpZiAoY29sLmlzQ3JlYXRhYmxlU2VsZWN0KSByZXR1cm4gY3JlYXRhYmxlU2VsZWN0UmVuZGVyKHsgLi4uZnNQcm9wcyB9KTtcbiAgICByZXR1cm4gc2VsZWN0UmVuZGVyKHsgLi4uZnNQcm9wcyB9KTtcbiAgfSxcblxuICBjZWxsRmlsdGVyKFxuICAgIGNvbCxcbiAgICBjb2x1bW4sXG4gICAgdGFiSW5kZXgsXG4gICAgZ3JpZElkLFxuICAgIHNlbGVjdE9wdGlvbnMsXG4gICAgc2VsZWN0VHJhbnNsYXRpb25zLFxuICAgIGVkaXRWYWx1ZVBhcnNlcixcbiAgICBmdW5jdGlvbnMsXG4gICkge1xuICAgIGNvbnN0IG9wdHMgPSBjb2wuZmlsdGVyU2VsZWN0T3B0aW9uc01vZCAmJiBzZWxlY3RPcHRpb25zXG4gICAgICA/IGNvbC5maWx0ZXJTZWxlY3RPcHRpb25zTW9kKHNlbGVjdE9wdGlvbnMuc2xpY2UoKSwgY29sKVxuICAgICAgOiBzZWxlY3RPcHRpb25zO1xuICAgIGNvbnN0IGZzUHJvcHMgPSB7XG4gICAgICBuYW1lOiBgb2NEYXRhZ3JpZEZpbHRlcklucHV0LSR7Z3JpZElkfS0ke2NvbHVtbi5jb2x1bW5LZXl9YCxcbiAgICAgIG9wdGlvbnM6IG9wdHMsXG4gICAgICB2YWx1ZTogZnVuY3Rpb25zLmdldEl0ZW1WYWx1ZShjb2wsIHsgc2VsZWN0T3B0aW9ucyB9KSxcbiAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbnMub25DZWxsVmFsdWVDaGFuZ2UoY29sLCBlZGl0VmFsdWVQYXJzZXIpLFxuICAgICAgaXNTZWFyY2hhYmxlOiBzZWxlY3RPcHRpb25zICYmIHNlbGVjdE9wdGlvbnMubGVuZ3RoID4gOSxcbiAgICAgIGlzQ2xlYXJhYmxlOiB0cnVlLFxuICAgICAgdGFiU2VsZWN0c1ZhbHVlOiBmYWxzZSxcbiAgICAgIHRhYkluZGV4LFxuICAgICAgLi4uY29sLmZpbHRlckNvbXBvbmVudFByb3BzLFxuICAgICAgLi4uc2VsZWN0VHJhbnNsYXRpb25zLFxuICAgIH07XG5cbiAgICByZXR1cm4gc2VsZWN0UmVuZGVyKHsgLi4uZnNQcm9wcyB9KTtcbiAgfSxcbn07XG4iXX0=