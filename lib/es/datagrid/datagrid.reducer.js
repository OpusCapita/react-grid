import Immutable, { Map, List } from 'immutable';
import { TYPES } from './datagrid.actions';
import { INITIAL_STATE } from './datagrid.constants';
import Utils from './datagrid.utils';
export default function datagridReducer(state, action) {
  if (state === void 0) {
    state = INITIAL_STATE;
  }

  switch (action.type) {
    case TYPES.PLATFORM_DATAGRID_INVALIDATE:
      return state.deleteIn([action.id, 'data']).deleteIn([action.id, 'allData']).deleteIn([action.id, 'session']).deleteIn([action.id, 'selectedCell']).deleteIn([action.id, 'editData']).deleteIn([action.id, 'createData']).deleteIn([action.id, 'createCellMessages']).deleteIn([action.id, 'cellMessages']);

    case TYPES.PLATFORM_DATAGRID_FORCE_REFRESH:
      return state.set('forceRefresh', Date.now());

    case TYPES.PLATFORM_DATAGRID_SET_DATA:
      return state.setIn([action.id, 'data'], action.data).setIn([action.id, 'allData'], action.data).setIn([action.id, 'config'], Immutable.fromJS(action.config)).setIn([action.id, 'selectedItems'], Immutable.fromJS(action.selectedItems)).mergeIn([action.id, 'session'], {
        isEditing: false,
        isCreating: false,
        isBusy: false
      }).deleteIn([action.id, 'selectedCell']).deleteIn([action.id, 'editData']).deleteIn([action.id, 'createData']).deleteIn([action.id, 'createCellMessages']).deleteIn([action.id, 'cellMessages']);

    case TYPES.PLATFORM_DATAGRID_BUSY:
      return state.setIn([action.id, 'session', 'isBusy'], true);

    case TYPES.PLATFORM_DATAGRID_READY:
      return state.setIn([action.id, 'session', 'isBusy'], false);

    case TYPES.PLATFORM_DATAGRID_APPLY_SORT:
      return state.setIn([action.id, 'data'], action.data).setIn([action.id, 'allData'], action.allData);

    case TYPES.PLATFORM_DATAGRID_SORT_CHANGE:
      return state.setIn([action.id, 'config', 'sortingData'], Map({
        sortColumn: action.sortColumn,
        sortOrder: action.sortOrder
      }));

    case TYPES.PLATFORM_DATAGRID_RESIZE_COLUMN:
      return state.setIn([action.id, 'config', 'columnWidths'], action.columnWidths);

    case TYPES.PLATFORM_DATAGRID_EDIT:
      return state.setIn([action.id, 'session', 'isEditing'], true);

    case TYPES.PLATFORM_DATAGRID_CREATE:
      return state.setIn([action.id, 'createData'], List([Immutable.fromJS(action.columnDefaultValues)])).deleteIn([action.id, 'selectedCell']).mergeIn([action.id, 'session'], {
        isCreating: true
      });

    case TYPES.PLATFORM_DATAGRID_ADD_NEW_ITEM:
      return state.updateIn([action.id, 'createData'], List(), function (items) {
        return items.push(Immutable.fromJS(action.columnDefaultValues));
      });

    case TYPES.PLATFORM_DATAGRID_REMOVE_ITEM:
      {
        var allDataIndex = state.getIn([action.id, 'allData'], List()).findIndex(function (item) {
          return item.getIn(action.idKeyPath) === action.rowId;
        });
        var dataIndex = state.getIn([action.id, 'data'], List()).findIndex(function (item) {
          return item.getIn(action.idKeyPath) === action.rowId;
        });
        return state.deleteIn([action.id, 'data', dataIndex]).deleteIn([action.id, 'allData', allDataIndex]).deleteIn([action.id, 'editData', action.rowId]).deleteIn([action.id, 'cellMessages', 'error', action.rowId]).deleteIn([action.id, 'cellMessages', 'info', action.rowId]).deleteIn([action.id, 'cellMessages', 'warning', action.rowId]);
      }

    case TYPES.PLATFORM_DATAGRID_SET_FOCUS_TO:
      {
        // focus type is saved as a immutable Map to make it easier to detect changes
        // when requesting same type of focus several times
        return state.setIn([action.id, 'session', 'focusType'], Map({
          type: action.focusTo,
          focusToLastRow: action.focusToLastRow
        }));
      }

    case TYPES.PLATFORM_DATAGRID_REMOVE_NEW_ITEM:
      return state.deleteIn([action.id, 'createData', action.index]);

    case TYPES.PLATFORM_DATAGRID_REMOVE_NEW_ITEMS:
      return state.setIn([action.id, 'createData'], state.getIn([action.id, 'createData'], List()).filter(function (val, idx) {
        return action.indexes.indexOf(idx) === -1;
      }));

    case TYPES.PLATFORM_DATAGRID_CANCEL:
      return state.mergeIn([action.id, 'session'], Map({
        isEditing: false,
        isCreating: false
      })).deleteIn([action.id, 'editData']).deleteIn([action.id, 'createData']).deleteIn([action.id, 'createCellMessages', 'error']).deleteIn([action.id, 'cellMessages', 'error']);

    case TYPES.PLATFORM_DATAGRID_SAVE:
      return state.setIn([action.id, 'session', 'isBusy'], true);

    case TYPES.PLATFORM_DATAGRID_EXTEND_DATA:
      {
        var allData = state.getIn([action.id, 'allData']);
        var extendedData = action.prepend ? action.data.concat(allData) : allData.concat(action.data);
        return state.setIn([action.id, 'data'], extendedData).setIn([action.id, 'allData'], extendedData);
      }

    case TYPES.PLATFORM_DATAGRID_SAVE_SUCCESS:
      {
        var _allData = state.getIn([action.id, 'allData']);

        var firstCreatedId = null;
        action.savedItems.forEach(function (savedItemJS) {
          var savedItem = Immutable.fromJS(savedItemJS);

          var foundIndex = _allData.findIndex(function (d) {
            return d.getIn(action.idKeyPath) === savedItem.getIn(action.idKeyPath);
          });

          if (foundIndex === -1) {
            if (!firstCreatedId && savedItem.getIn(action.idKeyPath)) {
              firstCreatedId = savedItem.getIn(action.idKeyPath);
            }

            _allData = _allData.push(savedItem);
          } else {
            _allData = _allData.mergeDeepIn([foundIndex], savedItem);
          }
        });
        var newState = state.setIn([action.id, 'data'], _allData).setIn([action.id, 'allData'], _allData).mergeIn([action.id, 'session'], {
          isBusy: false,
          isEditing: false,
          isCreating: false
        }).deleteIn([action.id, 'editData']).deleteIn([action.id, 'createData']).deleteIn([action.id, 'createCellMessages', 'error']).deleteIn([action.id, 'cellMessages', 'error']);

        if (firstCreatedId) {
          Utils.saveSelectedItems(action.id, [firstCreatedId]);
          newState = newState.setIn([action.id, 'selectedItems'], List([firstCreatedId]));
        }

        return newState;
      }

    case TYPES.PLATFORM_DATAGRID_SAVE_PARTIAL_SUCCESS:
      {
        var _allData2 = state.getIn([action.id, 'allData']);

        var createData = state.getIn([action.id, 'createData']);
        var editData = state.getIn([action.id, 'editData']);
        var isCreating = state.getIn([action.id, 'session', 'isCreating']);
        action.savedItems.forEach(function (savedItemJS) {
          var savedItem = Immutable.fromJS(savedItemJS);

          var foundIndex = _allData2.findIndex(function (d) {
            return d.getIn(action.idKeyPath) === savedItem.getIn(action.idKeyPath);
          });

          if (foundIndex === -1) {
            _allData2 = _allData2.push(savedItem);
          } else {
            _allData2 = _allData2.mergeDeepIn([foundIndex], savedItem);
          }

          if (isCreating) {
            foundIndex = savedItem.get('rowIndex');

            if (foundIndex !== undefined && foundIndex !== null) {
              createData = createData["delete"](foundIndex);
            }
          } else {
            editData = editData["delete"](savedItem.getIn(action.idKeyPath));
          }
        });
        return state.setIn([action.id, 'data'], _allData2).setIn([action.id, 'allData'], _allData2).setIn([action.id, 'createData'], createData).setIn([action.id, 'editData'], editData).setIn([action.id, 'session', 'isBusy'], false);
      }

    case TYPES.PLATFORM_DATAGRID_SAVE_FAIL:
      return state.setIn([action.id, 'session', 'isBusy'], false);

    case TYPES.PLATFORM_DATAGRID_REMOVE:
      return state.setIn([action.id, 'session', 'isBusy'], true);

    case TYPES.PLATFORM_DATAGRID_REMOVE_SUCCESS:
      return state.setIn([action.id, 'session', 'isBusy'], false).updateIn([action.id, 'data'], function (data) {
        return data.filterNot(function (item) {
          return action.removedIds.indexOf(item.getIn(action.idKeyPath)) > -1;
        });
      }).updateIn([action.id, 'allData'], function (data) {
        return data.filterNot(function (item) {
          return action.removedIds.indexOf(item.getIn(action.idKeyPath)) > -1;
        });
      }).deleteIn([action.id, 'selectedItems']);

    case TYPES.PLATFORM_DATAGRID_REMOVE_FAIL:
      return state.setIn([action.id, 'session', 'isBusy'], false);

    case TYPES.PLATFORM_DATAGRID_EDIT_CELL_VALUE_CHANGE:
      return state.setIn([action.id, 'editData', action.dataId].concat(action.keyPath), action.value);

    case TYPES.PLATFORM_DATAGRID_CREATE_CELL_VALUE_CHANGE:
      return state.setIn([action.id, 'createData', action.rowIndex].concat(action.keyPath), action.value);

    case TYPES.PLATFORM_DATAGRID_CELL_SHOW_MESSAGE:
      return state.setIn([action.id, 'cellMessages', action.messageType, action.dataId].concat(action.keyPath), {
        id: action.messageId,
        values: action.messageValues
      });

    case TYPES.PLATFORM_DATAGRID_CELL_SHOW_MESSAGES:
      return state.mergeIn([action.id, 'cellMessages'], Immutable.fromJS(action.messages));

    case TYPES.PLATFORM_DATAGRID_CELL_HIDE_MESSAGE:
      {
        if (action.messageType === null) {
          return state.deleteIn([action.id, 'cellMessages']);
        }

        if (action.dataId === null) {
          return state.deleteIn([action.id, 'cellMessages', action.messageType]);
        }

        var rowMessage = state.getIn([action.id, 'cellMessages', action.messageType, action.dataId]);

        if (rowMessage) {
          if (action.keyPath) {
            rowMessage = rowMessage.deleteIn(action.keyPath);
          }

          if (rowMessage.size === 0 || !action.keyPath) {
            return state.deleteIn([action.id, 'cellMessages', action.messageType, action.dataId]);
          }

          return state.setIn([action.id, 'cellMessages', action.messageType, action.dataId], rowMessage);
        }

        return state;
      }

    case TYPES.PLATFORM_DATAGRID_CREATE_CELL_SHOW_MESSAGE:
      return state.setIn([action.id, 'createCellMessages', action.messageType, action.rowIndex].concat(action.keyPath), {
        id: action.messageId,
        values: action.messageValues
      });

    case TYPES.PLATFORM_DATAGRID_CREATE_CELL_HIDE_MESSAGE:
      {
        if (action.messageType === null) {
          return state.deleteIn([action.id, 'createCellMessages']);
        }

        if (action.rowIndex === null) {
          return state.deleteIn([action.id, 'createCellMessages', action.messageType]);
        }

        var _rowMessage = state.getIn([action.id, 'createCellMessages', action.messageType, action.rowIndex]);

        if (_rowMessage) {
          if (action.keyPath) {
            _rowMessage = _rowMessage.deleteIn(action.keyPath);
          }

          if (_rowMessage.size === 0 || !action.keyPath) {
            return state.deleteIn([action.id, 'createCellMessages', action.messageType, action.rowIndex]);
          }

          return state.setIn([action.id, 'createCellMessages', action.messageType, action.rowIndex], _rowMessage);
        }

        return state;
      }

    case TYPES.PLATFORM_DATAGRID_CELL_SELECTION_CHANGE:
      return state.setIn([action.id, 'selectedCell'], action.selectedCell);

    case TYPES.PLATFORM_DATAGRID_ITEM_SELECTION_CHANGE:
      {
        var _newState = state.setIn([action.id, 'session', 'lastClickedRowIndex'], action.rowIndex); // Handle case where shift key is pressed
        // Select all rows from lastClickedRow to currently clicked row


        if (action.shiftPressed) {
          var lastRowIndex = state.getIn([action.id, 'session', 'lastClickedRowIndex'], false);

          if (lastRowIndex !== false) {
            var selectRowIds = [];

            if (lastRowIndex < action.rowIndex) {
              for (var i = lastRowIndex; i <= action.rowIndex; i += 1) {
                var _dataId = state.getIn([action.id, 'data', i].concat(action.idKeyPath));

                if (_dataId) {
                  selectRowIds.push(_dataId);
                }
              }
            } else {
              for (var _i = action.rowIndex; _i <= lastRowIndex; _i += 1) {
                var _dataId2 = state.getIn([action.id, 'data', _i].concat(action.idKeyPath));

                if (_dataId2) {
                  selectRowIds.push(_dataId2);
                }
              }
            }

            return _newState.setIn([action.id, 'selectedItems'], List(selectRowIds));
          }
        }

        var dataId = state.getIn([action.id, 'data', action.rowIndex].concat(action.idKeyPath));
        var foundIndex = state.getIn([action.id, 'selectedItems'], List()).indexOf(dataId);

        if (foundIndex === -1) {
          if (action.ctrlPressed) {
            return _newState.updateIn([action.id, 'selectedItems'], List(), function (items) {
              return items.push(dataId);
            });
          }

          return _newState.setIn([action.id, 'selectedItems'], List([dataId]));
        }

        if (action.ctrlPressed) {
          return _newState.updateIn([action.id, 'selectedItems'], function (items) {
            return items["delete"](foundIndex);
          });
        }

        return _newState.setIn([action.id, 'selectedItems'], List([dataId]));
      }

    case TYPES.PLATFORM_DATAGRID_SELECT_ALL_ITEMS_CHANGE:
      if (state.getIn([action.id, 'selectedItems'], List()).size === state.getIn([action.id, 'data'], List()).size) {
        return state.deleteIn([action.id, 'selectedItems']);
      }

      return state.setIn([action.id, 'selectedItems'], state.getIn([action.id, 'data'], List()).map(function (item) {
        return item.getIn(action.idKeyPath);
      }));

    case TYPES.PLATFORM_DATAGRID_CLEAR_SELECTED_ITEMS:
      return state.deleteIn([action.id, 'selectedItems']);

    case TYPES.PLATFORM_DATAGRID_TOGGLE_FILTERING:
      {
        if (!action.isFiltering) {
          return state.setIn([action.id, 'config', 'filteringData'], Map({
            isFiltering: false
          })).setIn([action.id, 'data'], state.getIn([action.id, 'allData']));
        }

        return state.setIn([action.id, 'config', 'filteringData'], Map({
          isFiltering: true
        }));
      }

    case TYPES.PLATFORM_DATAGRID_FILTER_DATA_CHANGE:
      return state.setIn([action.id, 'config', 'filteringData', 'filterData'], Immutable.fromJS(action.filterData));

    case TYPES.PLATFORM_DATAGRID_APPLY_FILTERS:
      return state.setIn([action.id, 'data'], action.data);

    case TYPES.PLATFORM_DATAGRID_SET_FILTERS:
      return state.setIn([action.id, 'config', 'filteringData'], action.filteringData);

    case TYPES.PLATFORM_DATAGRID_UPDATE_EXISTING_CELL_VALUE:
      {
        var indexAllData = state.getIn([action.grid.id, 'allData'], List()).findIndex(function (d) {
          return d.getIn(action.grid.idKeyPath) === action.dataId;
        });
        var indexData = state.getIn([action.grid.id, 'data'], List()).findIndex(function (d) {
          return d.getIn(action.grid.idKeyPath) === action.dataId;
        });

        if (indexAllData !== -1 && indexData !== -1) {
          return state.setIn([action.grid.id, 'allData', indexAllData].concat(action.keyPath), action.value).setIn([action.grid.id, 'data', indexData].concat(action.keyPath), action.value);
        }

        if (indexAllData !== -1) {
          return state.setIn([action.grid.id, 'allData', indexAllData].concat(action.keyPath), action.value);
        }

        if (indexData !== -1) {
          return state.setIn([action.grid.id, 'data', indexData].concat(action.keyPath), action.value);
        }

        return state;
      }

    case TYPES.PLATFORM_DATAGRID_SET_EDIT_DATA:
      return state.setIn([action.id, 'session', 'isEditing'], true).setIn([action.id, 'editData'], action.data).setIn([action.id, 'cellMessages'], action.cellMessages);

    case TYPES.PLATFORM_DATAGRID_COLUMN_SETTINGS_MODAL_OPEN:
      return state.setIn([action.id, 'session', 'columnSettingsModal', 'open'], true);

    case TYPES.PLATFORM_DATAGRID_COLUMN_SETTINGS_MODAL_CLOSE:
      return state.deleteIn([action.id, 'session', 'columnSettingsModal']);

    case TYPES.PLATFORM_DATAGRID_COLUMN_SETTINGS_SAVE:
      return state.setIn([action.id, 'config', 'visibleColumns'], Immutable.fromJS(action.columnOrder));

    case TYPES.PLATFORM_DATAGRID_SET_PAGE:
      return state.setIn([action.id, 'config', 'page'], action.page);

    case TYPES.PLATFORM_DATAGRID_SET_ROWS_ON_PAGE:
      return state.setIn([action.id, 'config', 'rowsOnPage'], action.rowsOnPage);

    default:
      return state;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9kYXRhZ3JpZC9kYXRhZ3JpZC5yZWR1Y2VyLmpzIl0sIm5hbWVzIjpbIkltbXV0YWJsZSIsIk1hcCIsIkxpc3QiLCJUWVBFUyIsIklOSVRJQUxfU1RBVEUiLCJVdGlscyIsImRhdGFncmlkUmVkdWNlciIsInN0YXRlIiwiYWN0aW9uIiwidHlwZSIsIlBMQVRGT1JNX0RBVEFHUklEX0lOVkFMSURBVEUiLCJkZWxldGVJbiIsImlkIiwiUExBVEZPUk1fREFUQUdSSURfRk9SQ0VfUkVGUkVTSCIsInNldCIsIkRhdGUiLCJub3ciLCJQTEFURk9STV9EQVRBR1JJRF9TRVRfREFUQSIsInNldEluIiwiZGF0YSIsImZyb21KUyIsImNvbmZpZyIsInNlbGVjdGVkSXRlbXMiLCJtZXJnZUluIiwiaXNFZGl0aW5nIiwiaXNDcmVhdGluZyIsImlzQnVzeSIsIlBMQVRGT1JNX0RBVEFHUklEX0JVU1kiLCJQTEFURk9STV9EQVRBR1JJRF9SRUFEWSIsIlBMQVRGT1JNX0RBVEFHUklEX0FQUExZX1NPUlQiLCJhbGxEYXRhIiwiUExBVEZPUk1fREFUQUdSSURfU09SVF9DSEFOR0UiLCJzb3J0Q29sdW1uIiwic29ydE9yZGVyIiwiUExBVEZPUk1fREFUQUdSSURfUkVTSVpFX0NPTFVNTiIsImNvbHVtbldpZHRocyIsIlBMQVRGT1JNX0RBVEFHUklEX0VESVQiLCJQTEFURk9STV9EQVRBR1JJRF9DUkVBVEUiLCJjb2x1bW5EZWZhdWx0VmFsdWVzIiwiUExBVEZPUk1fREFUQUdSSURfQUREX05FV19JVEVNIiwidXBkYXRlSW4iLCJpdGVtcyIsInB1c2giLCJQTEFURk9STV9EQVRBR1JJRF9SRU1PVkVfSVRFTSIsImFsbERhdGFJbmRleCIsImdldEluIiwiZmluZEluZGV4IiwiaXRlbSIsImlkS2V5UGF0aCIsInJvd0lkIiwiZGF0YUluZGV4IiwiUExBVEZPUk1fREFUQUdSSURfU0VUX0ZPQ1VTX1RPIiwiZm9jdXNUbyIsImZvY3VzVG9MYXN0Um93IiwiUExBVEZPUk1fREFUQUdSSURfUkVNT1ZFX05FV19JVEVNIiwiaW5kZXgiLCJQTEFURk9STV9EQVRBR1JJRF9SRU1PVkVfTkVXX0lURU1TIiwiZmlsdGVyIiwidmFsIiwiaWR4IiwiaW5kZXhlcyIsImluZGV4T2YiLCJQTEFURk9STV9EQVRBR1JJRF9DQU5DRUwiLCJQTEFURk9STV9EQVRBR1JJRF9TQVZFIiwiUExBVEZPUk1fREFUQUdSSURfRVhURU5EX0RBVEEiLCJleHRlbmRlZERhdGEiLCJwcmVwZW5kIiwiY29uY2F0IiwiUExBVEZPUk1fREFUQUdSSURfU0FWRV9TVUNDRVNTIiwiZmlyc3RDcmVhdGVkSWQiLCJzYXZlZEl0ZW1zIiwiZm9yRWFjaCIsInNhdmVkSXRlbUpTIiwic2F2ZWRJdGVtIiwiZm91bmRJbmRleCIsImQiLCJtZXJnZURlZXBJbiIsIm5ld1N0YXRlIiwic2F2ZVNlbGVjdGVkSXRlbXMiLCJQTEFURk9STV9EQVRBR1JJRF9TQVZFX1BBUlRJQUxfU1VDQ0VTUyIsImNyZWF0ZURhdGEiLCJlZGl0RGF0YSIsImdldCIsInVuZGVmaW5lZCIsIlBMQVRGT1JNX0RBVEFHUklEX1NBVkVfRkFJTCIsIlBMQVRGT1JNX0RBVEFHUklEX1JFTU9WRSIsIlBMQVRGT1JNX0RBVEFHUklEX1JFTU9WRV9TVUNDRVNTIiwiZmlsdGVyTm90IiwicmVtb3ZlZElkcyIsIlBMQVRGT1JNX0RBVEFHUklEX1JFTU9WRV9GQUlMIiwiUExBVEZPUk1fREFUQUdSSURfRURJVF9DRUxMX1ZBTFVFX0NIQU5HRSIsImRhdGFJZCIsImtleVBhdGgiLCJ2YWx1ZSIsIlBMQVRGT1JNX0RBVEFHUklEX0NSRUFURV9DRUxMX1ZBTFVFX0NIQU5HRSIsInJvd0luZGV4IiwiUExBVEZPUk1fREFUQUdSSURfQ0VMTF9TSE9XX01FU1NBR0UiLCJtZXNzYWdlVHlwZSIsIm1lc3NhZ2VJZCIsInZhbHVlcyIsIm1lc3NhZ2VWYWx1ZXMiLCJQTEFURk9STV9EQVRBR1JJRF9DRUxMX1NIT1dfTUVTU0FHRVMiLCJtZXNzYWdlcyIsIlBMQVRGT1JNX0RBVEFHUklEX0NFTExfSElERV9NRVNTQUdFIiwicm93TWVzc2FnZSIsInNpemUiLCJQTEFURk9STV9EQVRBR1JJRF9DUkVBVEVfQ0VMTF9TSE9XX01FU1NBR0UiLCJQTEFURk9STV9EQVRBR1JJRF9DUkVBVEVfQ0VMTF9ISURFX01FU1NBR0UiLCJQTEFURk9STV9EQVRBR1JJRF9DRUxMX1NFTEVDVElPTl9DSEFOR0UiLCJzZWxlY3RlZENlbGwiLCJQTEFURk9STV9EQVRBR1JJRF9JVEVNX1NFTEVDVElPTl9DSEFOR0UiLCJzaGlmdFByZXNzZWQiLCJsYXN0Um93SW5kZXgiLCJzZWxlY3RSb3dJZHMiLCJpIiwiY3RybFByZXNzZWQiLCJQTEFURk9STV9EQVRBR1JJRF9TRUxFQ1RfQUxMX0lURU1TX0NIQU5HRSIsIm1hcCIsIlBMQVRGT1JNX0RBVEFHUklEX0NMRUFSX1NFTEVDVEVEX0lURU1TIiwiUExBVEZPUk1fREFUQUdSSURfVE9HR0xFX0ZJTFRFUklORyIsImlzRmlsdGVyaW5nIiwiUExBVEZPUk1fREFUQUdSSURfRklMVEVSX0RBVEFfQ0hBTkdFIiwiZmlsdGVyRGF0YSIsIlBMQVRGT1JNX0RBVEFHUklEX0FQUExZX0ZJTFRFUlMiLCJQTEFURk9STV9EQVRBR1JJRF9TRVRfRklMVEVSUyIsImZpbHRlcmluZ0RhdGEiLCJQTEFURk9STV9EQVRBR1JJRF9VUERBVEVfRVhJU1RJTkdfQ0VMTF9WQUxVRSIsImluZGV4QWxsRGF0YSIsImdyaWQiLCJpbmRleERhdGEiLCJQTEFURk9STV9EQVRBR1JJRF9TRVRfRURJVF9EQVRBIiwiY2VsbE1lc3NhZ2VzIiwiUExBVEZPUk1fREFUQUdSSURfQ09MVU1OX1NFVFRJTkdTX01PREFMX09QRU4iLCJQTEFURk9STV9EQVRBR1JJRF9DT0xVTU5fU0VUVElOR1NfTU9EQUxfQ0xPU0UiLCJQTEFURk9STV9EQVRBR1JJRF9DT0xVTU5fU0VUVElOR1NfU0FWRSIsImNvbHVtbk9yZGVyIiwiUExBVEZPUk1fREFUQUdSSURfU0VUX1BBR0UiLCJwYWdlIiwiUExB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WSxDQUFDVixNQUFNLENBQUNJLEVBQVIsRUFBWSxTQUFaLEVBQXVCLHFCQUF2QixFQUE4QyxNQUE5QyxDQUFaLEVBQW1FLElBQW5FLENBQVA7O0FBRUYsU0FBS1QsS0FBSyxDQUFDa0ksNkNBQVg7QUFDRSxhQUFPOUgsS0FBSyxDQUFDSSxRQUFOLENBQWUsQ0FBQ0gsTUFBTSxDQUFDSSxFQUFSLEVBQVksU0FBWixFQUF1QixxQkFBdkIsQ0FBZixDQUFQOztBQUVGLFNBQUtULEtBQUssQ0FBQ21JLHNDQUFYO0FBQ0UsYUFBTy9ILEtBQUssQ0FBQ1csS0FBTixDQUNMLENBQUNWLE1BQU0sQ0FBQ0ksRUFBUixFQUFZLFFBQVosRUFBc0IsZ0JBQXRCLENBREssRUFFTFosU0FBUyxDQUFDb0IsTUFBVixDQUFpQlosTUFBTSxDQUFDK0gsV0FBeEIsQ0FGSyxDQUFQOztBQUtGLFNBQUtwSSxLQUFLLENBQUNxSSwwQkFBWDtBQUNFLGFBQU9qSSxLQUFLLENBQUNXLEtBQU4sQ0FBWSxDQUFDVixNQUFNLENBQUNJLEVBQVIsRUFBWSxRQUFaLEVBQXNCLE1BQXRCLENBQVosRUFBMkNKLE1BQU0sQ0FBQ2lJLElBQWxELENBQVA7O0FBRUYsU0FBS3RJLEtBQUssQ0FBQ3VJLGtDQUFYO0FBQ0UsYUFBT25JLEtBQUssQ0FBQ1csS0FBTixDQUFZLENBQUNWLE1BQU0sQ0FBQ0ksRUFBUixFQUFZLFFBQVosRUFBc0IsWUFBdEIsQ0FBWixFQUFpREosTUFBTSxDQUFDbUksVUFBeEQsQ0FBUDs7QUFFRjtBQUNFLGFBQU9wSSxLQUFQO0FBN2JKO0FBK2JEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEltbXV0YWJsZSwgeyBNYXAsIExpc3QgfSBmcm9tICdpbW11dGFibGUnO1xuaW1wb3J0IHsgVFlQRVMgfSBmcm9tICcuL2RhdGFncmlkLmFjdGlvbnMnO1xuaW1wb3J0IHsgSU5JVElBTF9TVEFURSB9IGZyb20gJy4vZGF0YWdyaWQuY29uc3RhbnRzJztcbmltcG9ydCBVdGlscyBmcm9tICcuL2RhdGFncmlkLnV0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZGF0YWdyaWRSZWR1Y2VyKHN0YXRlID0gSU5JVElBTF9TVEFURSwgYWN0aW9uKSB7XG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0lOVkFMSURBVEU6XG4gICAgICByZXR1cm4gc3RhdGVcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdkYXRhJ10pXG4gICAgICAgIC5kZWxldGVJbihbYWN0aW9uLmlkLCAnYWxsRGF0YSddKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdzZWxlY3RlZENlbGwnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdlZGl0RGF0YSddKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnXSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0ZPUkNFX1JFRlJFU0g6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0KCdmb3JjZVJlZnJlc2gnLCBEYXRlLm5vdygpKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU0VUX0RBVEE6XG4gICAgICByZXR1cm4gc3RhdGVcbiAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdkYXRhJ10sIGFjdGlvbi5kYXRhKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2FsbERhdGEnXSwgYWN0aW9uLmRhdGEpXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnY29uZmlnJ10sIEltbXV0YWJsZS5mcm9tSlMoYWN0aW9uLmNvbmZpZykpXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnc2VsZWN0ZWRJdGVtcyddLCBJbW11dGFibGUuZnJvbUpTKGFjdGlvbi5zZWxlY3RlZEl0ZW1zKSlcbiAgICAgICAgLm1lcmdlSW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nXSwge1xuICAgICAgICAgIGlzRWRpdGluZzogZmFsc2UsXG4gICAgICAgICAgaXNDcmVhdGluZzogZmFsc2UsXG4gICAgICAgICAgaXNCdXN5OiBmYWxzZSxcbiAgICAgICAgfSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdzZWxlY3RlZENlbGwnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdlZGl0RGF0YSddKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnXSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0JVU1k6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnaXNCdXN5J10sIHRydWUpO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9SRUFEWTpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdpc0J1c3knXSwgZmFsc2UpO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9BUFBMWV9TT1JUOlxuICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnZGF0YSddLCBhY3Rpb24uZGF0YSlcbiAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdhbGxEYXRhJ10sIGFjdGlvbi5hbGxEYXRhKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU09SVF9DSEFOR0U6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdjb25maWcnLCAnc29ydGluZ0RhdGEnXSxcbiAgICAgICAgTWFwKHtcbiAgICAgICAgICBzb3J0Q29sdW1uOiBhY3Rpb24uc29ydENvbHVtbixcbiAgICAgICAgICBzb3J0T3JkZXI6IGFjdGlvbi5zb3J0T3JkZXIsXG4gICAgICAgIH0pLFxuICAgICAgKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfUkVTSVpFX0NPTFVNTjpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnY29uZmlnJywgJ2NvbHVtbldpZHRocyddLCBhY3Rpb24uY29sdW1uV2lkdGhzKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfRURJVDpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdpc0VkaXRpbmcnXSwgdHJ1ZSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0NSRUFURTpcbiAgICAgIHJldHVybiBzdGF0ZVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSwgTGlzdChbSW1tdXRhYmxlLmZyb21KUyhhY3Rpb24uY29sdW1uRGVmYXVsdFZhbHVlcyldKSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdzZWxlY3RlZENlbGwnXSlcbiAgICAgICAgLm1lcmdlSW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nXSwge1xuICAgICAgICAgIGlzQ3JlYXRpbmc6IHRydWUsXG4gICAgICAgIH0pO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9BRERfTkVXX0lURU06XG4gICAgICByZXR1cm4gc3RhdGUudXBkYXRlSW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdjcmVhdGVEYXRhJ10sXG4gICAgICAgIExpc3QoKSxcbiAgICAgICAgaXRlbXMgPT4gaXRlbXMucHVzaChJbW11dGFibGUuZnJvbUpTKGFjdGlvbi5jb2x1bW5EZWZhdWx0VmFsdWVzKSksXG4gICAgICApO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9SRU1PVkVfSVRFTToge1xuICAgICAgY29uc3QgYWxsRGF0YUluZGV4ID0gc3RhdGVcbiAgICAgICAgLmdldEluKFthY3Rpb24uaWQsICdhbGxEYXRhJ10sIExpc3QoKSlcbiAgICAgICAgLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uZ2V0SW4oYWN0aW9uLmlkS2V5UGF0aCkgPT09IGFjdGlvbi5yb3dJZCk7XG4gICAgICBjb25zdCBkYXRhSW5kZXggPSBzdGF0ZVxuICAgICAgICAuZ2V0SW4oW2FjdGlvbi5pZCwgJ2RhdGEnXSwgTGlzdCgpKVxuICAgICAgICAuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSA9PT0gYWN0aW9uLnJvd0lkKTtcbiAgICAgIHJldHVybiBzdGF0ZVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2RhdGEnLCBkYXRhSW5kZXhdKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2FsbERhdGEnLCBhbGxEYXRhSW5kZXhdKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2VkaXREYXRhJywgYWN0aW9uLnJvd0lkXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCAnZXJyb3InLCBhY3Rpb24ucm93SWRdKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NlbGxNZXNzYWdlcycsICdpbmZvJywgYWN0aW9uLnJvd0lkXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCAnd2FybmluZycsIGFjdGlvbi5yb3dJZF0pO1xuICAgIH1cblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU0VUX0ZPQ1VTX1RPOiB7XG4gICAgICAvLyBmb2N1cyB0eXBlIGlzIHNhdmVkIGFzIGEgaW1tdXRhYmxlIE1hcCB0byBtYWtlIGl0IGVhc2llciB0byBkZXRlY3QgY2hhbmdlc1xuICAgICAgLy8gd2hlbiByZXF1ZXN0aW5nIHNhbWUgdHlwZSBvZiBmb2N1cyBzZXZlcmFsIHRpbWVzXG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdzZXNzaW9uJywgJ2ZvY3VzVHlwZSddLFxuICAgICAgICBNYXAoeyB0eXBlOiBhY3Rpb24uZm9jdXNUbywgZm9jdXNUb0xhc3RSb3c6IGFjdGlvbi5mb2N1c1RvTGFzdFJvdyB9KSxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9SRU1PVkVfTkVXX0lURU06XG4gICAgICByZXR1cm4gc3RhdGUuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnLCBhY3Rpb24uaW5kZXhdKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfUkVNT1ZFX05FV19JVEVNUzpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihcbiAgICAgICAgW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSxcbiAgICAgICAgc3RhdGVcbiAgICAgICAgICAuZ2V0SW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSwgTGlzdCgpKVxuICAgICAgICAgIC5maWx0ZXIoKHZhbCwgaWR4KSA9PiBhY3Rpb24uaW5kZXhlcy5pbmRleE9mKGlkeCkgPT09IC0xKSxcbiAgICAgICk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0NBTkNFTDpcbiAgICAgIHJldHVybiBzdGF0ZVxuICAgICAgICAubWVyZ2VJbihcbiAgICAgICAgICBbYWN0aW9uLmlkLCAnc2Vzc2lvbiddLFxuICAgICAgICAgIE1hcCh7XG4gICAgICAgICAgICBpc0VkaXRpbmc6IGZhbHNlLFxuICAgICAgICAgICAgaXNDcmVhdGluZzogZmFsc2UsXG4gICAgICAgICAgfSksXG4gICAgICAgIClcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdlZGl0RGF0YSddKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnLCAnZXJyb3InXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCAnZXJyb3InXSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1NBVkU6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnaXNCdXN5J10sIHRydWUpO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9FWFRFTkRfREFUQToge1xuICAgICAgY29uc3QgYWxsRGF0YSA9IHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdhbGxEYXRhJ10pO1xuICAgICAgY29uc3QgZXh0ZW5kZWREYXRhID0gYWN0aW9uLnByZXBlbmRcbiAgICAgICAgPyBhY3Rpb24uZGF0YS5jb25jYXQoYWxsRGF0YSlcbiAgICAgICAgOiBhbGxEYXRhLmNvbmNhdChhY3Rpb24uZGF0YSk7XG5cbiAgICAgIHJldHVybiBzdGF0ZVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2RhdGEnXSwgZXh0ZW5kZWREYXRhKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2FsbERhdGEnXSwgZXh0ZW5kZWREYXRhKTtcbiAgICB9XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1NBVkVfU1VDQ0VTUzoge1xuICAgICAgbGV0IGFsbERhdGEgPSBzdGF0ZS5nZXRJbihbYWN0aW9uLmlkLCAnYWxsRGF0YSddKTtcbiAgICAgIGxldCBmaXJzdENyZWF0ZWRJZCA9IG51bGw7XG5cbiAgICAgIGFjdGlvbi5zYXZlZEl0ZW1zLmZvckVhY2goKHNhdmVkSXRlbUpTKSA9PiB7XG4gICAgICAgIGNvbnN0IHNhdmVkSXRlbSA9IEltbXV0YWJsZS5mcm9tSlMoc2F2ZWRJdGVtSlMpO1xuICAgICAgICBjb25zdCBmb3VuZEluZGV4ID0gYWxsRGF0YS5maW5kSW5kZXgoXG4gICAgICAgICAgZCA9PiBkLmdldEluKGFjdGlvbi5pZEtleVBhdGgpID09PSBzYXZlZEl0ZW0uZ2V0SW4oYWN0aW9uLmlkS2V5UGF0aCksXG4gICAgICAgICk7XG4gICAgICAgIGlmIChmb3VuZEluZGV4ID09PSAtMSkge1xuICAgICAgICAgIGlmICghZmlyc3RDcmVhdGVkSWQgJiYgc2F2ZWRJdGVtLmdldEluKGFjdGlvbi5pZEtleVBhdGgpKSB7XG4gICAgICAgICAgICBmaXJzdENyZWF0ZWRJZCA9IHNhdmVkSXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWxsRGF0YSA9IGFsbERhdGEucHVzaChzYXZlZEl0ZW0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFsbERhdGEgPSBhbGxEYXRhLm1lcmdlRGVlcEluKFtmb3VuZEluZGV4XSwgc2F2ZWRJdGVtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGxldCBuZXdTdGF0ZSA9IHN0YXRlXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnZGF0YSddLCBhbGxEYXRhKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2FsbERhdGEnXSwgYWxsRGF0YSlcbiAgICAgICAgLm1lcmdlSW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nXSwge1xuICAgICAgICAgIGlzQnVzeTogZmFsc2UsXG4gICAgICAgICAgaXNFZGl0aW5nOiBmYWxzZSxcbiAgICAgICAgICBpc0NyZWF0aW5nOiBmYWxzZSxcbiAgICAgICAgfSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdlZGl0RGF0YSddKVxuICAgICAgICAuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnLCAnZXJyb3InXSlcbiAgICAgICAgLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCAnZXJyb3InXSk7XG5cbiAgICAgIGlmIChmaXJzdENyZWF0ZWRJZCkge1xuICAgICAgICBVdGlscy5zYXZlU2VsZWN0ZWRJdGVtcyhhY3Rpb24uaWQsIFtmaXJzdENyZWF0ZWRJZF0pO1xuICAgICAgICBuZXdTdGF0ZSA9IG5ld1N0YXRlLnNldEluKFthY3Rpb24uaWQsICdzZWxlY3RlZEl0ZW1zJ10sIExpc3QoW2ZpcnN0Q3JlYXRlZElkXSkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3U3RhdGU7XG4gICAgfVxuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9TQVZFX1BBUlRJQUxfU1VDQ0VTUzoge1xuICAgICAgbGV0IGFsbERhdGEgPSBzdGF0ZS5nZXRJbihbYWN0aW9uLmlkLCAnYWxsRGF0YSddKTtcbiAgICAgIGxldCBjcmVhdGVEYXRhID0gc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnXSk7XG4gICAgICBsZXQgZWRpdERhdGEgPSBzdGF0ZS5nZXRJbihbYWN0aW9uLmlkLCAnZWRpdERhdGEnXSk7XG4gICAgICBjb25zdCBpc0NyZWF0aW5nID0gc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnaXNDcmVhdGluZyddKTtcbiAgICAgIGFjdGlvbi5zYXZlZEl0ZW1zLmZvckVhY2goKHNhdmVkSXRlbUpTKSA9PiB7XG4gICAgICAgIGNvbnN0IHNhdmVkSXRlbSA9IEltbXV0YWJsZS5mcm9tSlMoc2F2ZWRJdGVtSlMpO1xuICAgICAgICBsZXQgZm91bmRJbmRleCA9IGFsbERhdGEuZmluZEluZGV4KFxuICAgICAgICAgIGQgPT4gZC5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSA9PT0gc2F2ZWRJdGVtLmdldEluKGFjdGlvbi5pZEtleVBhdGgpLFxuICAgICAgICApO1xuICAgICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICBhbGxEYXRhID0gYWxsRGF0YS5wdXNoKHNhdmVkSXRlbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWxsRGF0YSA9IGFsbERhdGEubWVyZ2VEZWVwSW4oW2ZvdW5kSW5kZXhdLCBzYXZlZEl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NyZWF0aW5nKSB7XG4gICAgICAgICAgZm91bmRJbmRleCA9IHNhdmVkSXRlbS5nZXQoJ3Jvd0luZGV4Jyk7XG4gICAgICAgICAgaWYgKGZvdW5kSW5kZXggIT09IHVuZGVmaW5lZCAmJiBmb3VuZEluZGV4ICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjcmVhdGVEYXRhID0gY3JlYXRlRGF0YS5kZWxldGUoZm91bmRJbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVkaXREYXRhID0gZWRpdERhdGEuZGVsZXRlKHNhdmVkSXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnZGF0YSddLCBhbGxEYXRhKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2FsbERhdGEnXSwgYWxsRGF0YSlcbiAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdjcmVhdGVEYXRhJ10sIGNyZWF0ZURhdGEpXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnZWRpdERhdGEnXSwgZWRpdERhdGEpXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdpc0J1c3knXSwgZmFsc2UpO1xuICAgIH1cblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU0FWRV9GQUlMOlxuICAgICAgcmV0dXJuIHN0YXRlLnNldEluKFthY3Rpb24uaWQsICdzZXNzaW9uJywgJ2lzQnVzeSddLCBmYWxzZSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1JFTU9WRTpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdpc0J1c3knXSwgdHJ1ZSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1JFTU9WRV9TVUNDRVNTOlxuICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgIC5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdpc0J1c3knXSwgZmFsc2UpXG4gICAgICAgIC51cGRhdGVJbihcbiAgICAgICAgICBbYWN0aW9uLmlkLCAnZGF0YSddLFxuICAgICAgICAgIGRhdGEgPT4gZGF0YS5maWx0ZXJOb3QoXG4gICAgICAgICAgICBpdGVtID0+IGFjdGlvbi5yZW1vdmVkSWRzLmluZGV4T2YoaXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSkgPiAtMSxcbiAgICAgICAgICApLFxuICAgICAgICApXG4gICAgICAgIC51cGRhdGVJbihcbiAgICAgICAgICBbYWN0aW9uLmlkLCAnYWxsRGF0YSddLFxuICAgICAgICAgIGRhdGEgPT4gZGF0YS5maWx0ZXJOb3QoXG4gICAgICAgICAgICBpdGVtID0+IGFjdGlvbi5yZW1vdmVkSWRzLmluZGV4T2YoaXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSkgPiAtMSxcbiAgICAgICAgICApLFxuICAgICAgICApXG4gICAgICAgIC5kZWxldGVJbihbYWN0aW9uLmlkLCAnc2VsZWN0ZWRJdGVtcyddKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfUkVNT1ZFX0ZBSUw6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnaXNCdXN5J10sIGZhbHNlKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfRURJVF9DRUxMX1ZBTFVFX0NIQU5HRTpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnZWRpdERhdGEnLCBhY3Rpb24uZGF0YUlkLCAuLi5hY3Rpb24ua2V5UGF0aF0sIGFjdGlvbi52YWx1ZSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0NSRUFURV9DRUxMX1ZBTFVFX0NIQU5HRTpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihcbiAgICAgICAgW2FjdGlvbi5pZCwgJ2NyZWF0ZURhdGEnLCBhY3Rpb24ucm93SW5kZXgsIC4uLmFjdGlvbi5rZXlQYXRoXSxcbiAgICAgICAgYWN0aW9uLnZhbHVlLFxuICAgICAgKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQ0VMTF9TSE9XX01FU1NBR0U6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCBhY3Rpb24ubWVzc2FnZVR5cGUsIGFjdGlvbi5kYXRhSWQsIC4uLmFjdGlvbi5rZXlQYXRoXSxcbiAgICAgICAgeyBpZDogYWN0aW9uLm1lc3NhZ2VJZCwgdmFsdWVzOiBhY3Rpb24ubWVzc2FnZVZhbHVlcyB9LFxuICAgICAgKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQ0VMTF9TSE9XX01FU1NBR0VTOlxuICAgICAgcmV0dXJuIHN0YXRlLm1lcmdlSW4oW2FjdGlvbi5pZCwgJ2NlbGxNZXNzYWdlcyddLCBJbW11dGFibGUuZnJvbUpTKGFjdGlvbi5tZXNzYWdlcykpO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9DRUxMX0hJREVfTUVTU0FHRToge1xuICAgICAgaWYgKGFjdGlvbi5tZXNzYWdlVHlwZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gc3RhdGUuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ2NlbGxNZXNzYWdlcyddKTtcbiAgICAgIH1cbiAgICAgIGlmIChhY3Rpb24uZGF0YUlkID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZS5kZWxldGVJbihbYWN0aW9uLmlkLCAnY2VsbE1lc3NhZ2VzJywgYWN0aW9uLm1lc3NhZ2VUeXBlXSk7XG4gICAgICB9XG4gICAgICBsZXQgcm93TWVzc2FnZSA9IHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCBhY3Rpb24ubWVzc2FnZVR5cGUsIGFjdGlvbi5kYXRhSWRdKTtcbiAgICAgIGlmIChyb3dNZXNzYWdlKSB7XG4gICAgICAgIGlmIChhY3Rpb24ua2V5UGF0aCkge1xuICAgICAgICAgIHJvd01lc3NhZ2UgPSByb3dNZXNzYWdlLmRlbGV0ZUluKGFjdGlvbi5rZXlQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93TWVzc2FnZS5zaXplID09PSAwIHx8ICFhY3Rpb24ua2V5UGF0aCkge1xuICAgICAgICAgIHJldHVybiBzdGF0ZS5kZWxldGVJbihbYWN0aW9uLmlkLCAnY2VsbE1lc3NhZ2VzJywgYWN0aW9uLm1lc3NhZ2VUeXBlLCBhY3Rpb24uZGF0YUlkXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN0YXRlLnNldEluKFxuICAgICAgICAgIFthY3Rpb24uaWQsICdjZWxsTWVzc2FnZXMnLCBhY3Rpb24ubWVzc2FnZVR5cGUsIGFjdGlvbi5kYXRhSWRdLFxuICAgICAgICAgIHJvd01lc3NhZ2UsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3RhdGU7XG4gICAgfVxuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9DUkVBVEVfQ0VMTF9TSE9XX01FU1NBR0U6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnLCBhY3Rpb24ubWVzc2FnZVR5cGUsIGFjdGlvbi5yb3dJbmRleCwgLi4uYWN0aW9uLmtleVBhdGhdLFxuICAgICAgICB7IGlkOiBhY3Rpb24ubWVzc2FnZUlkLCB2YWx1ZXM6IGFjdGlvbi5tZXNzYWdlVmFsdWVzIH0sXG4gICAgICApO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9DUkVBVEVfQ0VMTF9ISURFX01FU1NBR0U6IHtcbiAgICAgIGlmIChhY3Rpb24ubWVzc2FnZVR5cGUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlLmRlbGV0ZUluKFthY3Rpb24uaWQsICdjcmVhdGVDZWxsTWVzc2FnZXMnXSk7XG4gICAgICB9XG4gICAgICBpZiAoYWN0aW9uLnJvd0luZGV4ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZS5kZWxldGVJbihbYWN0aW9uLmlkLCAnY3JlYXRlQ2VsbE1lc3NhZ2VzJywgYWN0aW9uLm1lc3NhZ2VUeXBlXSk7XG4gICAgICB9XG4gICAgICBsZXQgcm93TWVzc2FnZSA9IHN0YXRlLmdldEluKFtcbiAgICAgICAgYWN0aW9uLmlkLFxuICAgICAgICAnY3JlYXRlQ2VsbE1lc3NhZ2VzJyxcbiAgICAgICAgYWN0aW9uLm1lc3NhZ2VUeXBlLFxuICAgICAgICBhY3Rpb24ucm93SW5kZXgsXG4gICAgICBdKTtcbiAgICAgIGlmIChyb3dNZXNzYWdlKSB7XG4gICAgICAgIGlmIChhY3Rpb24ua2V5UGF0aCkge1xuICAgICAgICAgIHJvd01lc3NhZ2UgPSByb3dNZXNzYWdlLmRlbGV0ZUluKGFjdGlvbi5rZXlQYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm93TWVzc2FnZS5zaXplID09PSAwIHx8ICFhY3Rpb24ua2V5UGF0aCkge1xuICAgICAgICAgIHJldHVybiBzdGF0ZS5kZWxldGVJbihbXG4gICAgICAgICAgICBhY3Rpb24uaWQsXG4gICAgICAgICAgICAnY3JlYXRlQ2VsbE1lc3NhZ2VzJyxcbiAgICAgICAgICAgIGFjdGlvbi5tZXNzYWdlVHlwZSxcbiAgICAgICAgICAgIGFjdGlvbi5yb3dJbmRleCxcbiAgICAgICAgICBdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgICAgW2FjdGlvbi5pZCwgJ2NyZWF0ZUNlbGxNZXNzYWdlcycsIGFjdGlvbi5tZXNzYWdlVHlwZSwgYWN0aW9uLnJvd0luZGV4XSxcbiAgICAgICAgICByb3dNZXNzYWdlLFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0YXRlO1xuICAgIH1cblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQ0VMTF9TRUxFQ1RJT05fQ0hBTkdFOlxuICAgICAgcmV0dXJuIHN0YXRlLnNldEluKFthY3Rpb24uaWQsICdzZWxlY3RlZENlbGwnXSwgYWN0aW9uLnNlbGVjdGVkQ2VsbCk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX0lURU1fU0VMRUNUSU9OX0NIQU5HRToge1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2Vzc2lvbicsICdsYXN0Q2xpY2tlZFJvd0luZGV4J10sIGFjdGlvbi5yb3dJbmRleCk7XG5cbiAgICAgIC8vIEhhbmRsZSBjYXNlIHdoZXJlIHNoaWZ0IGtleSBpcyBwcmVzc2VkXG4gICAgICAvLyBTZWxlY3QgYWxsIHJvd3MgZnJvbSBsYXN0Q2xpY2tlZFJvdyB0byBjdXJyZW50bHkgY2xpY2tlZCByb3dcbiAgICAgIGlmIChhY3Rpb24uc2hpZnRQcmVzc2VkKSB7XG4gICAgICAgIGNvbnN0IGxhc3RSb3dJbmRleCA9IHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdzZXNzaW9uJywgJ2xhc3RDbGlja2VkUm93SW5kZXgnXSwgZmFsc2UpO1xuICAgICAgICBpZiAobGFzdFJvd0luZGV4ICE9PSBmYWxzZSkge1xuICAgICAgICAgIGNvbnN0IHNlbGVjdFJvd0lkcyA9IFtdO1xuICAgICAgICAgIGlmIChsYXN0Um93SW5kZXggPCBhY3Rpb24ucm93SW5kZXgpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBsYXN0Um93SW5kZXg7IGkgPD0gYWN0aW9uLnJvd0luZGV4OyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgY29uc3QgZGF0YUlkID0gc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ2RhdGEnLCBpLCAuLi5hY3Rpb24uaWRLZXlQYXRoXSk7XG4gICAgICAgICAgICAgIGlmIChkYXRhSWQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RSb3dJZHMucHVzaChkYXRhSWQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBhY3Rpb24ucm93SW5kZXg7IGkgPD0gbGFzdFJvd0luZGV4OyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgY29uc3QgZGF0YUlkID0gc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ2RhdGEnLCBpLCAuLi5hY3Rpb24uaWRLZXlQYXRoXSk7XG4gICAgICAgICAgICAgIGlmIChkYXRhSWQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RSb3dJZHMucHVzaChkYXRhSWQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBuZXdTdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2VsZWN0ZWRJdGVtcyddLCBMaXN0KHNlbGVjdFJvd0lkcykpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGFJZCA9IHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdkYXRhJywgYWN0aW9uLnJvd0luZGV4LCAuLi5hY3Rpb24uaWRLZXlQYXRoXSk7XG4gICAgICBjb25zdCBmb3VuZEluZGV4ID0gc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ3NlbGVjdGVkSXRlbXMnXSwgTGlzdCgpKS5pbmRleE9mKGRhdGFJZCk7XG4gICAgICBpZiAoZm91bmRJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgaWYgKGFjdGlvbi5jdHJsUHJlc3NlZCkge1xuICAgICAgICAgIHJldHVybiBuZXdTdGF0ZS51cGRhdGVJbihcbiAgICAgICAgICAgIFthY3Rpb24uaWQsICdzZWxlY3RlZEl0ZW1zJ10sXG4gICAgICAgICAgICBMaXN0KCksXG4gICAgICAgICAgICBpdGVtcyA9PiBpdGVtcy5wdXNoKGRhdGFJZCksXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3U3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ3NlbGVjdGVkSXRlbXMnXSwgTGlzdChbZGF0YUlkXSkpO1xuICAgICAgfVxuICAgICAgaWYgKGFjdGlvbi5jdHJsUHJlc3NlZCkge1xuICAgICAgICByZXR1cm4gbmV3U3RhdGUudXBkYXRlSW4oW2FjdGlvbi5pZCwgJ3NlbGVjdGVkSXRlbXMnXSwgaXRlbXMgPT4gaXRlbXMuZGVsZXRlKGZvdW5kSW5kZXgpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXdTdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnc2VsZWN0ZWRJdGVtcyddLCBMaXN0KFtkYXRhSWRdKSk7XG4gICAgfVxuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9TRUxFQ1RfQUxMX0lURU1TX0NIQU5HRTpcbiAgICAgIGlmIChcbiAgICAgICAgc3RhdGUuZ2V0SW4oW2FjdGlvbi5pZCwgJ3NlbGVjdGVkSXRlbXMnXSwgTGlzdCgpKS5zaXplXG4gICAgICAgID09PSBzdGF0ZS5nZXRJbihbYWN0aW9uLmlkLCAnZGF0YSddLCBMaXN0KCkpLnNpemVcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gc3RhdGUuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ3NlbGVjdGVkSXRlbXMnXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdzZWxlY3RlZEl0ZW1zJ10sXG4gICAgICAgIHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdkYXRhJ10sIExpc3QoKSkubWFwKGl0ZW0gPT4gaXRlbS5nZXRJbihhY3Rpb24uaWRLZXlQYXRoKSksXG4gICAgICApO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9DTEVBUl9TRUxFQ1RFRF9JVEVNUzpcbiAgICAgIHJldHVybiBzdGF0ZS5kZWxldGVJbihbYWN0aW9uLmlkLCAnc2VsZWN0ZWRJdGVtcyddKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfVE9HR0xFX0ZJTFRFUklORzoge1xuICAgICAgaWYgKCFhY3Rpb24uaXNGaWx0ZXJpbmcpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdjb25maWcnLCAnZmlsdGVyaW5nRGF0YSddLCBNYXAoeyBpc0ZpbHRlcmluZzogZmFsc2UgfSkpXG4gICAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdkYXRhJ10sIHN0YXRlLmdldEluKFthY3Rpb24uaWQsICdhbGxEYXRhJ10pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnY29uZmlnJywgJ2ZpbHRlcmluZ0RhdGEnXSwgTWFwKHsgaXNGaWx0ZXJpbmc6IHRydWUgfSkpO1xuICAgIH1cblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfRklMVEVSX0RBVEFfQ0hBTkdFOlxuICAgICAgcmV0dXJuIHN0YXRlLnNldEluKFthY3Rpb24uaWQsICdjb25maWcnLCAnZmlsdGVyaW5nRGF0YScsICdmaWx0ZXJEYXRhJ10sIEltbXV0YWJsZS5mcm9tSlMoYWN0aW9uLmZpbHRlckRhdGEpKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQVBQTFlfRklMVEVSUzpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnZGF0YSddLCBhY3Rpb24uZGF0YSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1NFVF9GSUxURVJTOlxuICAgICAgcmV0dXJuIHN0YXRlLnNldEluKFthY3Rpb24uaWQsICdjb25maWcnLCAnZmlsdGVyaW5nRGF0YSddLCBhY3Rpb24uZmlsdGVyaW5nRGF0YSk7XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1VQREFURV9FWElTVElOR19DRUxMX1ZBTFVFOiB7XG4gICAgICBjb25zdCBpbmRleEFsbERhdGEgPSBzdGF0ZVxuICAgICAgICAuZ2V0SW4oW2FjdGlvbi5ncmlkLmlkLCAnYWxsRGF0YSddLCBMaXN0KCkpXG4gICAgICAgIC5maW5kSW5kZXgoZCA9PiBkLmdldEluKGFjdGlvbi5ncmlkLmlkS2V5UGF0aCkgPT09IGFjdGlvbi5kYXRhSWQpO1xuICAgICAgY29uc3QgaW5kZXhEYXRhID0gc3RhdGVcbiAgICAgICAgLmdldEluKFthY3Rpb24uZ3JpZC5pZCwgJ2RhdGEnXSwgTGlzdCgpKVxuICAgICAgICAuZmluZEluZGV4KGQgPT4gZC5nZXRJbihhY3Rpb24uZ3JpZC5pZEtleVBhdGgpID09PSBhY3Rpb24uZGF0YUlkKTtcbiAgICAgIGlmIChpbmRleEFsbERhdGEgIT09IC0xICYmIGluZGV4RGF0YSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgICAgLnNldEluKFthY3Rpb24uZ3JpZC5pZCwgJ2FsbERhdGEnLCBpbmRleEFsbERhdGEsIC4uLmFjdGlvbi5rZXlQYXRoXSwgYWN0aW9uLnZhbHVlKVxuICAgICAgICAgIC5zZXRJbihbYWN0aW9uLmdyaWQuaWQsICdkYXRhJywgaW5kZXhEYXRhLCAuLi5hY3Rpb24ua2V5UGF0aF0sIGFjdGlvbi52YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAoaW5kZXhBbGxEYXRhICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gc3RhdGVcbiAgICAgICAgICAuc2V0SW4oW2FjdGlvbi5ncmlkLmlkLCAnYWxsRGF0YScsIGluZGV4QWxsRGF0YSwgLi4uYWN0aW9uLmtleVBhdGhdLCBhY3Rpb24udmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKGluZGV4RGF0YSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlXG4gICAgICAgICAgLnNldEluKFthY3Rpb24uZ3JpZC5pZCwgJ2RhdGEnLCBpbmRleERhdGEsIC4uLmFjdGlvbi5rZXlQYXRoXSwgYWN0aW9uLnZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG5cbiAgICBjYXNlIFRZUEVTLlBMQVRGT1JNX0RBVEFHUklEX1NFVF9FRElUX0RBVEE6XG4gICAgICByZXR1cm4gc3RhdGVcbiAgICAgICAgLnNldEluKFthY3Rpb24uaWQsICdzZXNzaW9uJywgJ2lzRWRpdGluZyddLCB0cnVlKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2VkaXREYXRhJ10sIGFjdGlvbi5kYXRhKVxuICAgICAgICAuc2V0SW4oW2FjdGlvbi5pZCwgJ2NlbGxNZXNzYWdlcyddLCBhY3Rpb24uY2VsbE1lc3NhZ2VzKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQ09MVU1OX1NFVFRJTkdTX01PREFMX09QRU46XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnY29sdW1uU2V0dGluZ3NNb2RhbCcsICdvcGVuJ10sIHRydWUpO1xuXG4gICAgY2FzZSBUWVBFUy5QTEFURk9STV9EQVRBR1JJRF9DT0xVTU5fU0VUVElOR1NfTU9EQUxfQ0xPU0U6XG4gICAgICByZXR1cm4gc3RhdGUuZGVsZXRlSW4oW2FjdGlvbi5pZCwgJ3Nlc3Npb24nLCAnY29sdW1uU2V0dGluZ3NNb2RhbCddKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfQ09MVU1OX1NFVFRJTkdTX1NBVkU6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oXG4gICAgICAgIFthY3Rpb24uaWQsICdjb25maWcnLCAndmlzaWJsZUNvbHVtbnMnXSxcbiAgICAgICAgSW1tdXRhYmxlLmZyb21KUyhhY3Rpb24uY29sdW1uT3JkZXIpLFxuICAgICAgKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU0VUX1BBR0U6XG4gICAgICByZXR1cm4gc3RhdGUuc2V0SW4oW2FjdGlvbi5pZCwgJ2NvbmZpZycsICdwYWdlJ10sIGFjdGlvbi5wYWdlKTtcblxuICAgIGNhc2UgVFlQRVMuUExBVEZPUk1fREFUQUdSSURfU0VUX1JPV1NfT05fUEFHRTpcbiAgICAgIHJldHVybiBzdGF0ZS5zZXRJbihbYWN0aW9uLmlkLCAnY29uZmlnJywgJ3Jvd3NPblBhZ2UnXSwgYWN0aW9uLnJvd3NPblBhZ2UpO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufVxuIl19